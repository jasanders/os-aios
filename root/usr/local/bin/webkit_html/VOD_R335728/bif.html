<html>
<head>
<style>

body {
background-attachment:fixed;
background-color:#000000;
background-position:center;
background-repeat:no-repeat;
}



object.class0{
	position: absolute;
	top:0;
	left:0;
        z-index:-1;
}

.class1{
	position: absolute;
	background:url(0902/web_movie_bg.png) no-repeat;
	left:0px;
	top:460px; 
	width:1280px;
	height:260px;
}

a{
	font-size:20px;
	position: relative;
	margin-right:auto;
	margin-left:auto;
	z-index:3;
}
img.percentImage1 {
 background: black url(0902/web_movie_progress_bar.png) top left no-repeat;
 padding: 0;
 margin: 5px 0 0 0;
 background-position: 1px 0;
 width: 935px;
 height: 8px;
}
</style>
<script type="text/javascript" src="./webtoolkit.sprintf.js"></script>
<script type="text/javascript" src="./progress.js"></script>
<script> 

var url_path;
var url_path = './';
var thumbnails_path = './thumbnails';
var curImgNum;
var vdoMap2ImgNum;	//video frame current time
var state = 'inPlay';
var fullScreenPlay = 0;
var timeInterval = 500;
var videoObj = new CommonUtil;
//setProgress("element1", 50);

function showPluginTime(imgNum)
{
	      var array = new Array();
        array[0] = 180+Math.floor(935*imgNum/imgNumMax);
        array[1] = 460;
        trr = document.getElementById("myvideoObj");
        array[2] = GetCurTime((imgNum-1)*10);
       var mmm = trr.getXY(array);
}
function showImg(imgNum)
{
	setProgress("element1", (imgNum/imgNumMax)*100);
       
        showPluginTime(imgNum);

	if(imgNum == 1)
	{
    document.getElementById('img1').style.visibility = 'hidden';
	  document.getElementById('bg1').style.visibility = 'hidden';
	  
	  document.getElementById('img2').style.visibility = 'hidden';
	  document.getElementById('bg2').style.visibility = 'hidden';
	  
	  document.getElementById('img3').style.visibility = 'visible';
	  document.getElementById('bg3').style.visibility = 'visible';
	  document.getElementById('img3').src = thumbnails_path + '/image_' + sprintf("%03d.jpg",imgNum);
	  
	  document.getElementById('img4').style.visibility = 'visible';
	  document.getElementById('bg4').style.visibility = 'visible';
	  document.getElementById('img4').src = thumbnails_path + '/image_' + sprintf("%03d.jpg",(imgNum+1));
	  
	  document.getElementById('img5').style.visibility = 'visible';
	  document.getElementById('bg5').style.visibility = 'visible';
	  document.getElementById('img5').src = thumbnails_path + '/image_' + sprintf("%03d.jpg",(imgNum+2));
	}
	else if(imgNum == 2)
	{
		document.getElementById('img1').style.visibility = 'hidden';
	  document.getElementById('bg1').style.visibility = 'hidden';
	  
	  document.getElementById('img2').style.visibility = 'visible';
	  document.getElementById('bg2').style.visibility = 'visible';
	  document.getElementById('img2').src = thumbnails_path + '/image_' + sprintf("%03d.jpg",(imgNum-1));
	  
	  document.getElementById('img3').style.visibility = 'visible';
	  document.getElementById('bg3').style.visibility = 'visible';
	  document.getElementById('img3').src = thumbnails_path + '/image_' + sprintf("%03d.jpg",imgNum);
	  
	  document.getElementById('img4').style.visibility = 'visible';
	  document.getElementById('bg4').style.visibility = 'visible';
	  document.getElementById('img4').src = thumbnails_path + '/image_' + sprintf("%03d.jpg",(imgNum+1));
	  
	  document.getElementById('img5').style.visibility = 'visible';
	  document.getElementById('bg5').style.visibility = 'visible';
	  document.getElementById('img5').src = thumbnails_path + '/image_' + sprintf("%03d.jpg",(imgNum+2));
	}
	else if(imgNum == imgNumMax-1){
		document.getElementById('img1').style.visibility = 'visible';
	  document.getElementById('bg1').style.visibility = 'visible';
	  document.getElementById('img1').src = thumbnails_path + '/image_' + sprintf("%03d.jpg",(imgNum-2));
	  	  
	  document.getElementById('img2').style.visibility = 'visible';
	  document.getElementById('bg2').style.visibility = 'visible';
	  document.getElementById('img2').src = thumbnails_path + '/image_' + sprintf("%03d.jpg",(imgNum-1));
	  
	  document.getElementById('img3').style.visibility = 'visible';
	  document.getElementById('bg3').style.visibility = 'visible';
	  document.getElementById('img3').src = thumbnails_path + '/image_' + sprintf("%03d.jpg",imgNum);
	  
	  document.getElementById('img4').style.visibility = 'visible';
	  document.getElementById('bg4').style.visibility = 'visible';
	  document.getElementById('img4').src = thumbnails_path + '/image_' + sprintf("%03d.jpg",(imgNum-1));
	  
	  document.getElementById('img5').style.visibility = 'hidden';
	  document.getElementById('bg5').style.visibility = 'hidden';
	}
	else if(imgNum == imgNumMax){
		document.getElementById('img1').style.visibility = 'visible';
	  document.getElementById('bg1').style.visibility = 'visible';
	  document.getElementById('img1').src = thumbnails_path + '/image_' + sprintf("%03d.jpg",(imgNum-2));
	  	  
	  document.getElementById('img2').style.visibility = 'visible';
	  document.getElementById('bg2').style.visibility = 'visible';
	  document.getElementById('img2').src = thumbnails_path + '/image_' + sprintf("%03d.jpg",(imgNum-1));
	  
	  document.getElementById('img3').style.visibility = 'visible';
	  document.getElementById('bg3').style.visibility = 'visible';
	  document.getElementById('img3').src = thumbnails_path + '/image_' + sprintf("%03d.jpg",imgNum);
	  
	  document.getElementById('img4').style.visibility = 'hidden';
	  document.getElementById('bg4').style.visibility = 'hidden';
	  
	  document.getElementById('img5').style.visibility = 'hidden';
	  document.getElementById('bg5').style.visibility = 'hidden';
	}
	else{
		document.getElementById('img1').style.visibility = 'visible';
	  document.getElementById('bg1').style.visibility = 'visible';
	  document.getElementById('img1').src = thumbnails_path + '/image_' + sprintf("%03d.jpg",(imgNum-2));
	  	  
	  document.getElementById('img2').style.visibility = 'visible';
	  document.getElementById('bg2').style.visibility = 'visible';
	  document.getElementById('img2').src = thumbnails_path + '/image_' + sprintf("%03d.jpg",(imgNum-1));
	  
	  document.getElementById('img3').style.visibility = 'visible';
	  document.getElementById('bg3').style.visibility = 'visible';
	  document.getElementById('img3').src = thumbnails_path + '/image_' + sprintf("%03d.jpg",imgNum);
	  
	  document.getElementById('img4').style.visibility = 'visible';
	  document.getElementById('bg4').style.visibility = 'visible';
	  document.getElementById('img4').src = thumbnails_path + '/image_' + sprintf("%03d.jpg",(imgNum+1));
	  
	  document.getElementById('img5').style.visibility = 'visible';
	  document.getElementById('bg5').style.visibility = 'visible';
	  document.getElementById('img5').src = thumbnails_path + '/image_' + sprintf("%03d.jpg",(imgNum+2));
	}
	  
}
var buffering_count = 0;
function buffering()
{
	if(buffering_count > 10)
	{
	    videoObj.execCmd("playback_hideOsd");
		buffering_count = 0;
	} 
	else 
	{
		setProgress("element1", buffering_count * 10);
		if(buffering_count == 8)
		{
			startPlay();
		}
		setTimeout("buffering()", 250);
	}
	buffering_count++;
}

function init()
{
	var param = window.name.split(":::");
	video_file = param[0];
	imgNumMax = eval(param[1]);
	window.console.debug(param);
	
	url_path = video_file.substring(0, video_file.lastIndexOf('/'));
	window.console.debug("url_path=" + url_path);
	window.console.debug("length=" + imgNumMax);
	
	thumbnails_path = url_path + "/thumbnails";

	curImgNum=1;
	showImg(1);
        video_file = param[0];
//	startPlay();
  var totaltime = videoObj.execCmd("playback_getTotalTime");
  showTotleTime(totaltime);
  //setTimeout("pausePlay()",1000);      
  setTimeout("buffering()", 250);      
}


function timer_start()
{
	var nextTime = 'yes';
//	document.getElementById('index'+index).style.opacity = op_val;
	if(state == 'inBackward')
	{
		if(curImgNum > 10)
			curImgNum -= 10;
		else
		{
			nextTime = 'no';
			curImgNum = 1;
		}
	}
	else
	{
		if(curImgNum < imgNumMax - 10)
			curImgNum += 10;
		else
		{
			nextTime = 'no';
			curImgNum = imgNumMax;
		}
		
	}
	hideSmallthumbs();
	document.getElementById('img3').src = thumbnails_path + '/image_' + sprintf("%03d.jpg",curImgNum);
	setProgress("element1", (curImgNum/imgNumMax)*100);
	showPluginTime(curImgNum);
	
	if(nextTime == 'no')
	{
		clearInterval(ttt);
		state = 'inPause';
		showSmallthumbs();
//		draw(index, 1);
		window.console.debug("state=" + state);
	}
	else
	{
		ttt = setTimeout("timer_start()", timeInterval);
	}
	
}


function hideSmallthumbs()
{
	  document.getElementById('img1').style.visibility = 'hidden';
	  document.getElementById('bg1').style.visibility = 'hidden';
	  
	  document.getElementById('img2').style.visibility = 'hidden';
	  document.getElementById('bg2').style.visibility = 'hidden';
	  
	  document.getElementById('img4').style.visibility = 'hidden';
	  document.getElementById('bg4').style.visibility = 'hidden';
	  
	  document.getElementById('img5').style.visibility = 'hidden';
	  document.getElementById('bg5').style.visibility = 'hidden';
}
function showSmallthumbs()
{
	 document.getElementById('img1').style.visibility = 'visible';
	  document.getElementById('bg1').style.visibility = 'visible';
	  
	  document.getElementById('img2').style.visibility = 'visible';
	  document.getElementById('bg2').style.visibility = 'visible';
	  
	  document.getElementById('img4').style.visibility = 'visible';
	  document.getElementById('bg4').style.visibility = 'visible';
	  
	  document.getElementById('img5').style.visibility = 'visible';
	  document.getElementById('bg5').style.visibility = 'visible';
	  showImg(curImgNum);
	  setProgress("element1", (curImgNum/length)*100);
}

function whichButton(event)
{
	
//	alert("event.keyCode=" + event.keyCode);
	window.console.debug("keycode=" + event.keyCode);
	window.console.debug("state=" + state);
	switch(state)
	{
	case 'inPlay':
		if( event.keyCode == 13)
		{
			fullScreenPlay = 0;
      pausePlay();
      var curTime = videoObj.execCmd("playback_getCurTime");
      curImgNum = Math.floor(curTime/10)+1;
      if(curImgNum>imgNumMax)
     {
       curImgNum = imgNumMax;
     }
	vdoMap2ImgNum = curImgNum;
     showImg(curImgNum);
		 state = 'inPause';
	 }
	 return;
	case 'inPause':
	   if (event.keyCode == 37)	// left 
	  {//¡û
		  if(curImgNum==1)
		  	return;
		  else 
	  	{
		  		curImgNum = curImgNum -1 ;
		  		showImg(curImgNum);
	  	}
	  }
	
  	else if (event.keyCode == 39)	  // right 
	  {//¡ú
	  	if(curImgNum == imgNumMax)
		  {
		  	return;
		  }
		  else
		  {
			  curImgNum = curImgNum + 1 ;
			  showImg(curImgNum);
		  }	
	  }
	else if( event.keyCode == 38) //up
	{
		state = 'inPlay';
		resumePlay();
    	videoObj.execCmd("playback_hideOsd");
	}
	  else if( event.keyCode == 13)
	  {
	   	document.getElementById('myvideoObj').style.visibility = 'visible';
		state = 'inPlay';
		if(vdoMap2ImgNum == curImgNum)	//video frame not changed
		{
			resumePlay();
    		videoObj.execCmd("playback_hideOsd");
		}
		else
		{
			seekPlay();
		}
			return;
	  }		
		else if(event.keyCode == 66) //backward
		{
			hideSmallthumbs();
			state = 'inBackward';
			ttt = setTimeout("timer_start()", timeInterval);
		}
		else if(event.keyCode == 70) //forward
		{
			hideSmallthumbs();
			state = 'inForward';
			ttt = setTimeout("timer_start()", timeInterval);
		}
		break;
	case 'inBackward':	
	case 'inForward':
	  if(event.keyCode == 70) //forward
		{
			state = 'inForward';
		}
		if(event.keyCode == 66) //backward
		{
			state = 'inBackward';
		}
		if( event.keyCode == 13)
		{
			clearInterval(ttt);
			showSmallthumbs();
			state = 'inPause';
		}
		break;	
	default:
		return;
	}
}
</script>

<script>

var trr;
var ttt=0;
var ttt_h=0 ;
var ttt_m=0;
var ttt_s=0 ;
var tmp ;
//var timerPlay ;
function GetCurTime(v)
{

        ttt_h =  Math.floor(v / 3600) ; 
        ttt_m =  Math.floor((v % 3600) / 60)  ; 
        ttt_s = v % 60 ;
        
        if(ttt_m < 10)
        {
                if(ttt_s < 10)
                        tmp = ttt_h + ":0" + ttt_m + ":0" + ttt_s ;
                else
                        tmp = ttt_h + ":0" + ttt_m + ":" + ttt_s ;      
        }
        else
        {
                if(ttt_s < 10)
                        tmp = ttt_h + ":" + ttt_m + ":0" + ttt_s ;
                else
                        tmp = ttt_h + ":" + ttt_m + ":" + ttt_s ;               
        }
        return tmp;
}
function showTotleTime(v)
{

        ttt_h =  Math.floor(v / 3600) ; 
        ttt_m =  Math.floor((v % 3600) / 60)  ; 
        ttt_s = v % 60 ;
        
        if(ttt_m < 10)
        {
                if(ttt_s < 10)
                        tmp = ttt_h + ":0" + ttt_m + ":0" + ttt_s ;
                else
                        tmp = ttt_h + ":0" + ttt_m + ":" + ttt_s ;      
        }
        else
        {
                if(ttt_s < 10)
                        tmp = ttt_h + ":" + ttt_m + ":0" + ttt_s ;
                else
                        tmp = ttt_h + ":" + ttt_m + ":" + ttt_s ;               
        }
        document.getElementById("timer").innerHTML = tmp;
}
function onexit()
{
	videoObj.execCmd("playback_showOsd");
	videoObj.execCmd("playback_quitPlay");	
}				     

function startPlay()
{ //    alert(video_file);
	videoObj.execCmd("playback_setScreen",0,0,1280,720);
	videoObj.execCmd("playback_playVideo",video_file);
 //   videoObj.execCmd("playback_hideOsd");
}

function pausePlay()
{
    videoObj.execCmd("playback_pauseVideo");
    videoObj.execCmd("playback_showOsd");
}
function seekPlay()
{
    var time = (curImgNum-1) * 10;
    videoObj.execCmd("playback_seek", time);
    resumePlay();
    videoObj.execCmd("playback_hideOsd");
}
function resumePlay()
{
    videoObj.execCmd("playback_continuePlay");
}

</script>

</head>

<body width='100%' height='100%' onkeydown="whichButton(event)" onload="init()" onunload="onexit()">

<object class='class0' type="application/video"   id='myvideoObj' url="aaa" x=0 y=0 width='1280' height='462'>
</object>

<div class='class1' style='position:absolute'>
<span style='z-index:5;position:absolute;left:180px;top:2px;border:1px;visibility:visible'>
<script>display('element1',15,1);
	</script>
</span>
<span id='timer' style='position:absolute;z-index:4;left:1124px;top:0px;'><p style='color:#000000;font-size:16px;font-family:Arial'></p></span>	

<span  style='position:absolute;z-index:5;left:180px;top:54px;visibility:visible'><a id='anchor5'
href=""><img id='bg1' border=0 
src="0902/web_movie_icon_left_.png" v:shapes="_x0000_s1043"></a></span>
<span  style='position:
absolute;z-index:9;left:185px;top:73px;width:150px;height:85px;visibility:visible'><a
href=""><img id='img1' border=0  style='width:150px;height:85px;'
src="0902/1.png" v:shapes="_x0000_s1047"></a></span>

<span  style='position:absolute;z-index:5;left:351px;top:54px;visibility:visible'><a
href=""><img id='bg2' border=0
src="0902/web_movie_icon_left_.png" v:shapes="_x0000_s1044"></a></span>
<span  style='position:absolute;z-index:9;left:356px;top:73px;width:150px;height:85px;visibility:visible'><a
href=""><img id='img2' border=0  style='width:150px;height:85px;'
src="0902/1.png" v:shapes="_x0000_s1047"></a></span>

<span  style='position:absolute;z-index:6;left:522px;top:40px;visibility:visible'><a
href=""><img id='bg3' border=0 
src="0902/web_movie_icon_focus_.png" v:shapes="_x0000_s1045"></a></span>
<span  style='position:
absolute;z-index:9;left:546px;top:65px;width:200px;height:115px;visibility:visible'><a
href=""><img id='img3' border=0  style='width:200px;height:115px;' 
src="0902/1.png" v:shapes="_x0000_s1047" ></a></span>

<span  style='position:absolute;z-index:5;left:781px;top:54px;visibility:visible'><a
href=""><img id='bg4' border=0
src="0902/web_movie_icon_right_.png" v:shapes="_x0000_s1046"></a></span>
<span  style='position:absolute;z-index:9;left:786px;top:73px;width:150px;height:85px;visibility:visible'><a
href=""><img id='img4' border=0  style='width:150px;height:85px;' 
src="0902/1.png" v:shapes="_x0000_s1047"></a></span>

<span  style='position:absolute;z-index:5;left:953px;top:54px;visibility:visible'><a
href=""><img id='bg5' border=0  
src="0902/web_movie_icon_right_.png" v:shapes="_x0000_s1047"></a></span>
<span  style='position:absolute;z-index:9;left:959px;top:73px;width:150px;height:85px;visibility:visible'><a
href=""><img id='img5' border=0  style='width:150px;height:85px;'
src="0902/1.png" v:shapes="_x0000_s1047"></a></span>

</body>
</html>
