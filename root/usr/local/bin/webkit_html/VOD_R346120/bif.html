<html>
<head>
<style>

body{
    background-attachment:fixed;
    background-color:black;
    background-position:center;
    background-repeat:no-repeat;
}

.class0{
    position: absolute;
    top:0px;
    left:0px;
    z-index:-1;
}

.class1{
    position: absolute;
    background:url(0902/web_movie_bg.png) repeat;
    left:0px;
    top:460px; 
    width:1280px;
    height:260px;
}

a{
    font-size:20px;
    position: relative;
    margin-right:auto;
    margin-left:auto;
    z-index:3;
}

img.percentImage1 {
    background: black url(0902/web_movie_progress_bar.png) top left no-repeat;
    padding: 0;
    margin: 5px 0 0 0;
    background-position: 1px 0;
    width: 935px;
    height: 8px;
}
</style>

<script type="text/javascript" src="./webtoolkit.sprintf.js"></script>
<script type="text/javascript" src="./progress.js"></script>

<script> 
var subSelectIndex =0;
var trackSelectIndex = 0;

var thumbnails_host_path = './thumbnails';
var thumbnails_server_path= './thumbnails';;
var curImgNum;
var imgNumMax = 1;
var vdoMap2ImgNum;	//video frame current time
var state = 'inPlay';
var timeInterval = 500;

var bufferingCatchedPercentage = 0;
var videoObj = new CommonUtil;
var volumeValue;
var isDownLoadOver = false;
var TrackMenuSelectItem = 0;
var trackAudioItemNum = 0;
var subtitleItemNum = 0;

var per_tar_thumbnail_num;
var currentTar = -1;
var isClosed = false;
var inTmp = new Array();
var hasDownloadSuccess = new Array();

var loadMediaFail = 2;
var loadMediaSuccess =3;
var playCompleted = 7;
var networkDiscontinue = 8;
var notResponseButton = true;
var buffering_detect_time = 0;
var bufferStreamSize_old = 0;
var buffering_detect_max_time = 50;

function showPluginTime(imgNum)
{
    var array = new Array();
    array[0] = 180+Math.floor(935*imgNum/imgNumMax);
    array[1] = 460;
    trr = document.getElementById("myvideoObj");
    array[2] = GetCurTime((imgNum-1)*10);
    var mmm = trr.showSelectMenu(array);
}


function showImg(imgNum)
{
    setProgress("element1", (imgNum/imgNumMax)*100);   
    showPluginTime(imgNum);
  
   // var thumbnails_path = thumbnails_server_path;
    
    var thumbnails_path1 = thumbnails_server_path;
    var thumbnails_path2 = thumbnails_server_path;
    var thumbnails_path3 = thumbnails_server_path;
    var thumbnails_path4 = thumbnails_server_path;
    var thumbnails_path5 = thumbnails_server_path;

    
    if((imgNum-3)>0){
        var tarIndex = Math.floor((imgNum-3)/per_tar_thumbnail_num);
        if(tarIndex>9)
        tarIndex = 9;
         
        if(inTmp[tarIndex] == 0)
        {
            thumbnails_path1 = thumbnails_host_path + tarIndex;
        }
    }
    
if((imgNum-2)>0){
        var tarIndex = Math.floor((imgNum-2)/per_tar_thumbnail_num);
        if(tarIndex>9)
            tarIndex = 9;
         
        if(inTmp[tarIndex] == 0)
        {
            thumbnails_path2 = thumbnails_host_path + tarIndex;
        }
    }
    var tarIndex = Math.floor((imgNum-1)/per_tar_thumbnail_num);
    if(tarIndex>9)
        tarIndex = 9;
         
    if(inTmp[tarIndex] == 0)
    {
        thumbnails_path3 = thumbnails_host_path + tarIndex;
    }
    if((imgNum)<imgNumMax ){
        var tarIndex = Math.floor((imgNum)/per_tar_thumbnail_num);
        if(tarIndex>9)
            tarIndex = 9;
         
        if(inTmp[tarIndex] == 0)
        {
            thumbnails_path4 = thumbnails_host_path + tarIndex;
        }
    }
    
    if((imgNum+1)<imgNumMax ){
        var tarIndex = Math.floor((imgNum+1)/per_tar_thumbnail_num);
        if(tarIndex>9)
            tarIndex = 9;
         
        if(inTmp[tarIndex] == 0)
        {
            thumbnails_path5 = thumbnails_host_path + tarIndex;
        }
    }
   
    if(imgNum == 1)
    {
        document.getElementById('img1').style.visibility = 'hidden';
        document.getElementById('bg1').style.visibility = 'hidden';
	  
        document.getElementById('img2').style.visibility = 'hidden';
        document.getElementById('bg2').style.visibility = 'hidden';
	  
        document.getElementById('img3').style.visibility = 'visible';
        document.getElementById('bg3').style.visibility = 'visible';
        document.getElementById('img3').src = thumbnails_path3 + '/image_' + sprintf("%03d.jpg",imgNum);
	  
        document.getElementById('img4').style.visibility = 'visible';
        document.getElementById('bg4').style.visibility = 'visible';
        document.getElementById('img4').src = thumbnails_path4 + '/image_' + sprintf("%03d.jpg",(imgNum+1));
	  
        document.getElementById('img5').style.visibility = 'visible';
        document.getElementById('bg5').style.visibility = 'visible';
        document.getElementById('img5').src = thumbnails_path5 + '/image_' + sprintf("%03d.jpg",(imgNum+2));
    }
    
    else if(imgNum == 2)
    {
        document.getElementById('img1').style.visibility = 'hidden';
        document.getElementById('bg1').style.visibility = 'hidden';
	  
        document.getElementById('img2').style.visibility = 'visible';
        document.getElementById('bg2').style.visibility = 'visible';
        document.getElementById('img2').src = thumbnails_path2 + '/image_' + sprintf("%03d.jpg",(imgNum-1));
	  
        document.getElementById('img3').style.visibility = 'visible';
        document.getElementById('bg3').style.visibility = 'visible';
        document.getElementById('img3').src = thumbnails_path3 + '/image_' + sprintf("%03d.jpg",imgNum);
	  
        document.getElementById('img4').style.visibility = 'visible';
        document.getElementById('bg4').style.visibility = 'visible';
        document.getElementById('img4').src = thumbnails_path4 + '/image_' + sprintf("%03d.jpg",(imgNum+1));
	  
        document.getElementById('img5').style.visibility = 'visible';
        document.getElementById('bg5').style.visibility = 'visible';
        document.getElementById('img5').src = thumbnails_path5 + '/image_' + sprintf("%03d.jpg",(imgNum+2));
    }
    
    else if(imgNum == imgNumMax-1){
        document.getElementById('img1').style.visibility = 'visible';
        document.getElementById('bg1').style.visibility = 'visible';
        document.getElementById('img1').src = thumbnails_path1 + '/image_' + sprintf("%03d.jpg",(imgNum-2));
	  	  
        document.getElementById('img2').style.visibility = 'visible';
        document.getElementById('bg2').style.visibility = 'visible';
        document.getElementById('img2').src = thumbnails_path2 + '/image_' + sprintf("%03d.jpg",(imgNum-1));
	  
        document.getElementById('img3').style.visibility = 'visible';
        document.getElementById('bg3').style.visibility = 'visible';
        document.getElementById('img3').src = thumbnails_path3 + '/image_' + sprintf("%03d.jpg",imgNum);
	  
        document.getElementById('img4').style.visibility = 'visible';
        document.getElementById('bg4').style.visibility = 'visible';
        document.getElementById('img4').src = thumbnails_path4 + '/image_' + sprintf("%03d.jpg",(imgNum+1));
	  
        document.getElementById('img5').style.visibility = 'hidden';
        document.getElementById('bg5').style.visibility = 'hidden';
    }
	
    else if(imgNum == imgNumMax){
        document.getElementById('img1').style.visibility = 'visible';
        document.getElementById('bg1').style.visibility = 'visible';
        document.getElementById('img1').src = thumbnails_path1 + '/image_' + sprintf("%03d.jpg",(imgNum-2));
	  	  
        document.getElementById('img2').style.visibility = 'visible';
        document.getElementById('bg2').style.visibility = 'visible';
        document.getElementById('img2').src = thumbnails_path2 + '/image_' + sprintf("%03d.jpg",(imgNum-1));
	  
        document.getElementById('img3').style.visibility = 'visible';
        document.getElementById('bg3').style.visibility = 'visible';
        document.getElementById('img3').src = thumbnails_path3 + '/image_' + sprintf("%03d.jpg",imgNum);
	  
        document.getElementById('img4').style.visibility = 'hidden';
        document.getElementById('bg4').style.visibility = 'hidden';
	  
        document.getElementById('img5').style.visibility = 'hidden';
        document.getElementById('bg5').style.visibility = 'hidden';
    }
    
    else{
        document.getElementById('img1').style.visibility = 'visible';
        document.getElementById('bg1').style.visibility = 'visible';
        document.getElementById('img1').src = thumbnails_path1 + '/image_' + sprintf("%03d.jpg",(imgNum-2));
	  	  
        document.getElementById('img2').style.visibility = 'visible';
        document.getElementById('bg2').style.visibility = 'visible';
        document.getElementById('img2').src = thumbnails_path2 + '/image_' + sprintf("%03d.jpg",(imgNum-1));
	  
        document.getElementById('img3').style.visibility = 'visible';
        document.getElementById('bg3').style.visibility = 'visible';
        document.getElementById('img3').src = thumbnails_path3 + '/image_' + sprintf("%03d.jpg",imgNum);
	  
        document.getElementById('img4').style.visibility = 'visible';
        document.getElementById('bg4').style.visibility = 'visible';
        document.getElementById('img4').src = thumbnails_path4 + '/image_' + sprintf("%03d.jpg",(imgNum+1));
	  
        document.getElementById('img5').style.visibility = 'visible';
        document.getElementById('bg5').style.visibility = 'visible';
        document.getElementById('img5').src = thumbnails_path5 + '/image_' + sprintf("%03d.jpg",(imgNum+2));
    }
}


function buffering()
{
   // var bufferStreamSize = videoObj.execCmd("playback_getCachedStreamSize");
   // window.console.debug("bufferStreamSize:" + bufferStreamSize);
 //   bufferingCatchedPercentage =bufferStreamSize/(1024*5);
    var getPTSString = videoObj.execCmd("playback_getPTS");
    var param = getPTSString.split("\n");
    var bufferStreamSize = param[3];
    window.console.debug("#############++++++======" + bufferStreamSize + "==========++++++++++############");
    bufferingCatchedPercentage =bufferStreamSize/9000;
    if(bufferingCatchedPercentage > 100)
    {
        hideOSD();
 //       resumePlay();
        startPlay();
        bufferingCatchedPercentage = 0;
        notResponseButton = false;
    } 
    else 
    {
        setProgress("element1", bufferingCatchedPercentage);

        if(bufferStreamSize_old >= bufferStreamSize)
                buffering_detect_time++;
        else{
		bufferStreamSize_old = bufferStreamSize;
                buffering_detect_time = 0;
	}
        	     
        if(buffering_detect_time >=buffering_detect_max_time)
        {
            window.console.debug("#####################################################");
            setProgress("element1", 100);
            hideOSD();
            startPlay();
            bufferingCatchedPercentage = 0;
            notResponseButton = false;
        }
        else
            setTimeout("buffering()", 200);
    }
}



function hasDownLoadOver()
{
    //window.console.debug("1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111");
    if(videoObj.isDownloadOver())
    {
        isDownLoadOver = true;
        for(var i =0;i<10;i++)
        {
            hasDownloadSuccess[i] = videoObj.hasDownloadSuccess(i);
        }
    }
    else
    {
        setTimeout("hasDownLoadOver()", 10000);
    }
  	
}

function changeTarfile()
{
    //window.console.debug("#############++++++======" + videoObj.execCmd("playback_getPTS")+"==========++++++++++############");
    if(isClosed)
        return;

    var loadStatus = videoObj.execCmd("playback_getStatus");
    window.console.debug("#############++++++======" + loadStatus+ "==========++++++++++############");
    window.console.debug(loadStatus);
    
    if(loadStatus == playCompleted)
        history.back();
        
    if(loadStatus == networkDiscontinue)
        history.back();
        
    var i;
    setTimeout("changeTarfile()", 10000);
    if(isDownLoadOver == false)
    {     
    	    window.console.debug("#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#");
          return;
    }
    var curTar = Math.floor(curImgNum/per_tar_thumbnail_num);
    if(curTar > 9)
        curTar = 9;
    if(currentTar !=curTar)
    {
        currentTar = curTar;
        for(i = 0; i<(curTar-1);i++)
        {
            if(inTmp[i] == 0)
            {
                inTmp[i] = -1;
                videoObj.delTar(i);
            }
        }
		
        for(i = currentTar+2; i < 10;i++)
        {
            if(inTmp[i] == 0)
            {
                inTmp[i] = -1;
                videoObj.delTar(i);
            }
        }
       
        if((hasDownloadSuccess[curTar]==true) &&(inTmp[curTar] == -1))
        {
            videoObj.addTar(curTar);
            inTmp[curTar] = 0;
        }
      
        if((hasDownloadSuccess[curTar-1]==true) && ((curTar-1) > -1)&&(inTmp[curTar-1] == -1))
        {
            videoObj.addTar(curTar-1);
            inTmp[curTar-1] = 0;
        }
            
        if((hasDownloadSuccess[curTar+1]==true) && ((curTar+1) < 10)&&(inTmp[curTar+1] == -1))
        {
            videoObj.addTar(curTar+1);
            inTmp[curTar+1] = 0;
        }
    }
}


function init()
{
    for(var array_index =0;array_index<10;array_index++)
    {
        inTmp[array_index]= -1;
        hasDownloadSuccess[array_index] = false;
    }
    isDownLoadOver = false;
    var param = window.name.split(":::");
    var video_file = param[0];
    imgNumMax = eval(param[1]);
    per_tar_thumbnail_num = Math.floor(imgNumMax/10);
	
    var url_path = video_file.substring(0, video_file.lastIndexOf('/'));
   // window.console.debug("url_path=" + url_path);
   // window.console.debug("length=" + imgNumMax);	
    var subtitleURL = url_path + "/subtitle.tar";
	
    videoObj.downLoadSubtitleFiles(subtitleURL);
    
    var now = new Date();
    var year = now.getFullYear();
    var month = now.getMonth();
    var day = now.getDate();
    var hour = now.getHours();
    var minute = now.getMinutes();
    var second = now.getSeconds();
    var dateString = year + '_' + month + '_' + day + '_' + hour + '_' + minute + '_' + second;
   
    var imgUrl = url_path + "/thumbnail_tar/";
    videoObj.downLoadThumbnailsFiles(imgUrl,dateString);
	
    thumbnails_host_path = "file:///tmp/" + dateString + "/thumbnail_";   
    thumbnails_server_path = url_path + '/thumbnails';
    curImgNum=1;
	
    document.getElementById('img1').style.visibility = 'hidden';
    document.getElementById('bg1').style.visibility = 'hidden';
	  
    document.getElementById('img2').style.visibility = 'hidden';
    document.getElementById('bg2').style.visibility = 'hidden';
	  
    document.getElementById('img3').src = url_path + '/thumbnails/image_001.jpg';
    document.getElementById('img4').src = url_path + '/thumbnails/image_002.jpg';
    document.getElementById('img5').src = url_path + '/thumbnails/image_003.jpg';

    hasDownLoadOver();
    
    videoObj.execCmd("playback_loadMedia",video_file);

   // startPlay();
    //pausePlay();

    hasLoadedMediaSuccess();
   // var totaltime = videoObj.execCmd("playback_getTotalTime");
   // showTotleTime(totaltime);
   // setTimeout("buffering()", 200);   
   changeTarfile();  
}

function hasLoadedMediaSuccess()
{
    var loadStatus = videoObj.execCmd("playback_getStatus");
    if(loadStatus == loadMediaFail){
        history.back();
    }

    else if(loadStatus == loadMediaSuccess){
        videoObj.execCmd("playback_pauseVideo");
        var totaltime = videoObj.execCmd("playback_getTotalTime");
        showTotleTime(totaltime);
        setTimeout("buffering()", 200);
    }

    else{
        setTimeout("hasLoadedMediaSuccess()", 200);
    }
}


function timer_start()
{
    var thumbnails_path = thumbnails_server_path;
  
    var nextTime = 'yes';
    if(state == 'inBackward')
    {
        if(curImgNum > 10)
            curImgNum -= 10;
        else
        {
            nextTime = 'no';
            curImgNum = 1;
        }
    }
    else
    {
        if(curImgNum < imgNumMax - 10)
            curImgNum += 10;
        else
        {
            nextTime = 'no';
            curImgNum = imgNumMax;
        }
    }
	
    hideSmallthumbs();
    
    var tarIndex = Math.floor((curImgNum-1)/per_tar_thumbnail_num);
    if(tarIndex>9)
        tarIndex = 9;
         
    if(inTmp[tarIndex] == 0)
    {
        thumbnails_path = thumbnails_host_path + tarIndex;
    }
    document.getElementById('img3').src = thumbnails_path + '/image_' + sprintf("%03d.jpg",curImgNum);
    setProgress("element1", (curImgNum/imgNumMax)*100);
    showPluginTime(curImgNum);
	
    if(nextTime == 'no')
    {
        clearInterval(ttt);
        state = 'inPause';
        showSmallthumbs();
        //window.console.debug("state=" + state);
    }
    else
    {
        ttt = setTimeout("timer_start()", timeInterval);
    }
}


function hideSmallthumbs()
{
    document.getElementById('img1').style.visibility = 'hidden';
    document.getElementById('bg1').style.visibility = 'hidden';
	  
    document.getElementById('img2').style.visibility = 'hidden';
    document.getElementById('bg2').style.visibility = 'hidden';
	  
    document.getElementById('img4').style.visibility = 'hidden';
    document.getElementById('bg4').style.visibility = 'hidden';
	  
    document.getElementById('img5').style.visibility = 'hidden';
    document.getElementById('bg5').style.visibility = 'hidden';
}


function showSmallthumbs()
{
    document.getElementById('img1').style.visibility = 'visible';
    document.getElementById('bg1').style.visibility = 'visible';
	  
    document.getElementById('img2').style.visibility = 'visible';
    document.getElementById('bg2').style.visibility = 'visible';
	  
    document.getElementById('img4').style.visibility = 'visible';
    document.getElementById('bg4').style.visibility = 'visible';
	  
    document.getElementById('img5').style.visibility = 'visible';
    document.getElementById('bg5').style.visibility = 'visible';
    showImg(curImgNum);
    setProgress("element1", (curImgNum/length)*100);
}


function whichButton(event)
{
    if(notResponseButton)
        return;
		
    window.console.debug("keycode=" + event.keyCode);
    window.console.debug("state=" + state);
    switch(state)
    {
        case 'inPlay':
            if( event.keyCode == 13)
            {
                pausePlay();
                var curTime = videoObj.execCmd("playback_getCurTime");
                curImgNum = Math.floor(curTime/10)+3;   
                     
                if(curImgNum>imgNumMax)
                {
                    curImgNum = imgNumMax;
                }
                      
                vdoMap2ImgNum = curImgNum;
                showImg(curImgNum);
                state = 'inPause';
            }
            
            else if (event.keyCode == 39){
            	  subtitleItemNum = videoObj.execCmd("playback_getSubNum");
            	  if(subtitleItemNum > 0)
            	  { 
                        if(subSelectIndex >= subtitleItemNum)
                             subSelectIndex = 0;
                        showSubtitleMenu(subSelectIndex);
                        trr = document.getElementById("myvideoObj");
                        var array = new Array();    
                        array[0] = 900;
                        array[1] = 250;
                        array[2] = subtitleItemNum*50;
                        array[3] = 280;
                        trr.creatScriptMenu(array);             
                        trr.showScriptMenu(0); 
                        state = 'inSubMenu';
            	  }
            	  else{
                        noSubtitleMenu();
                        trr = document.getElementById("myvideoObj");
                        var array = new Array();    
                        array[0] = 900;
                        array[1] = 250;
                        array[2] = 50;
                        array[3] = 280;
                        trr.creatScriptMenu(array);             
                        trr.showScriptMenu(0); 
                        state = 'inNoSelect';
            	  }    
                
            }
	            
            else if (event.keyCode == 37)	
            {
                trackAudioItemNum = videoObj.execCmd("playback_getAudioNum");      
                if(trackAudioItemNum > 0)
            	  { 
                        if(trackSelectIndex >= trackAudioItemNum)
				trackSelectIndex = 0;     
                        showTrackAudioMenu(trackSelectIndex);
                        trr = document.getElementById("myvideoObj");
                        var array = new Array();    
                        array[0] = 100;
                        array[1] = 250;
                        array[2] = trackAudioItemNum*50;
                        array[3] = 380; 
                        trr.creatScriptMenu(array);             
                        trr.showScriptMenu(0); 
                        state = 'inTrackMenu';
            	  }
            	  else{
            	  	noTrackAudioMenu();
                        trr = document.getElementById("myvideoObj");
                        var array = new Array();    
                        array[0] = 100;
                        array[1] = 250;
                        array[2] = 50;
                        array[3] = 380;
                        trr.creatScriptMenu(array);             
                        trr.showScriptMenu(0); 
                        state = 'inNoSelect';
            	  }
            }
            break;
	 
        case 'inPause':
            if (event.keyCode == 37)	// left 
            {//¡û
                if(curImgNum==1)
                    break;
                else 
                {
                    curImgNum = curImgNum -1 ;
                    showImg(curImgNum);
                }
            }
	  
            else if (event.keyCode == 39)	  // right 
            {//¡ú
                if(curImgNum == imgNumMax)
                {
                    break;
                }
                else
                {
                curImgNum = curImgNum + 1 ;
                showImg(curImgNum);
                }	
            }
	  
            else if( event.keyCode == 38) //up
	        {
                state = 'inPlay';
                resumePlay();
                hideOSD();
	        }
  
            else if( event.keyCode == 13)
            {
                document.getElementById('myvideoObj').style.visibility = 'visible';
                state = 'inPlay';
                if(vdoMap2ImgNum == curImgNum)	//video frame not changed
                {
                    resumePlay();
    		     
                }
                else
                {
                    seekPlay();
                } 
                
                hideOSD();
                trr = document.getElementById("myvideoObj");
                trr.returnPlaySurface(0); 
            }	
	  
            else if(event.keyCode == 66) //backward
            {
                hideSmallthumbs();
                state = 'inBackward';
                ttt = setTimeout("timer_start()", timeInterval);
            }
	  
            else if(event.keyCode == 70) //forward
            {
                hideSmallthumbs();
                state = 'inForward';
                ttt = setTimeout("timer_start()", timeInterval);
            }
	  
            break;
	   
    case 'inBackward':	
    case 'inForward':
        if(event.keyCode == 70) //forward
        {
            state = 'inForward';
        }
	      
        else if(event.keyCode == 66) //backward
        {
            state = 'inBackward';
        }
	      
        else if( event.keyCode == 13)
        {
            clearInterval(ttt);
            showSmallthumbs(); 
            state = 'inPause';
        }
		
        break;
		
    case 'inSubMenu':
        if(event.keyCode == 38){
            if(subSelectIndex == 0)
                subSelectIndex = 0;
            else
                subSelectIndex -= 1;
	   		   
            subtitleMenuItemSelect(subSelectIndex);
        }
	   	
        else if(event.keyCode == 40)
        {
            if(subSelectIndex == subtitleItemNum-1)
                subSelectIndex = subtitleItemNum-1;
            else
                subSelectIndex += 1;

            subtitleMenuItemSelect(subSelectIndex);
        }
	       
        else if(event.keyCode == 13)
        {
            trr = document.getElementById("myvideoObj");
            var mmm = trr.returnPlaySurface(0);     
            videoObj.execCmd("playback_switchSubTo",subSelectIndex);        	  
            state = 'inPlay';
        }
        
	else if( event.keyCode == 39) //up
        {
             state = 'inPlay';
             trr = document.getElementById("myvideoObj");
             var mmm = trr.returnPlaySurface(0);
        }

        break;
	         
    case 'inTrackMenu':
        if(event.keyCode == 38){
            if(trackSelectIndex == 0)
                trackSelectIndex = 0;
            else
                trackSelectIndex -= 1;
	   		   
            trackAudioMenuItemSelect(trackSelectIndex);
        }
	   	
        else if(event.keyCode == 40)
        {
            if(trackSelectIndex == trackAudioItemNum-1)
                trackSelectIndex = trackAudioItemNum-1;
            else
                trackSelectIndex += 1;

            trackAudioMenuItemSelect(trackSelectIndex);
        }
	       
        else if(event.keyCode == 13)
        {
            trr = document.getElementById("myvideoObj");
            var mmm = trr.returnPlaySurface(0);     
            videoObj.execCmd("playback_loadAudio",trackSelectIndex);        	  
            state = 'inPlay';
        }

	else if( event.keyCode == 37) //up
         {
              state = 'inPlay';
              trr = document.getElementById("myvideoObj");
              var mmm = trr.returnPlaySurface(0);
         }

        break;


	case 'inNoSelect':
	    if(event.keyCode == 13)
        { 
            trr = document.getElementById("myvideoObj");
            var mmm = trr.returnPlaySurface(0); 
            state = 'inPlay';
        }
	    break;
	default:
		  return;
	}
}


var trr;
var ttt=0;
var ttt_h=0 ;
var ttt_m=0;
var ttt_s=0 ;
var tmp ;


function GetCurTime(v)
{
    ttt_h =  Math.floor(v / 3600) ; 
    ttt_m =  Math.floor((v % 3600) / 60)  ; 
    ttt_s = v % 60 ;
        
    if(ttt_m < 10)
    {
    if(ttt_s < 10)
        tmp = ttt_h + ":0" + ttt_m + ":0" + ttt_s ;
    else
        tmp = ttt_h + ":0" + ttt_m + ":" + ttt_s ;      
    }
    else
    {
        if(ttt_s < 10)
            tmp = ttt_h + ":" + ttt_m + ":0" + ttt_s ;
        else
            tmp = ttt_h + ":" + ttt_m + ":" + ttt_s ;               
    }
    return tmp;
}


function showTotleTime(v)
{
    ttt_h =  Math.floor(v / 3600) ; 
    ttt_m =  Math.floor((v % 3600) / 60)  ; 
    ttt_s = v % 60 ;
        
    if(ttt_m < 10)
    {
        if(ttt_s < 10)
            tmp = ttt_h + ":0" + ttt_m + ":0" + ttt_s ;
        else
            tmp = ttt_h + ":0" + ttt_m + ":" + ttt_s ;      
    }
    else
    {
        if(ttt_s < 10)
            tmp = ttt_h + ":" + ttt_m + ":0" + ttt_s ;
        else
            tmp = ttt_h + ":" + ttt_m + ":" + ttt_s ;               
    }
    document.getElementById("timer").innerHTML = tmp;
}


function onexit()
{
    isClosed = true;
    
    videoObj.execCmd("playback_quitPlay");
    videoObj.systemClose();
    
}				     


function startPlay()
{ 
    videoObj.execCmd("playback_setScreen",0,0,1280,720);
    videoObj.execCmd("playback_play");
    videoObj.execCmd("playback_showSub","true");
	
}


function pausePlay()
{
    videoObj.execCmd("playback_pauseVideo");
    showOSD()
}


function seekPlay()
{
    var time = (curImgNum-3) * 10; 
    if(time<0) time = 0;  
    videoObj.execCmd("playback_seek", time);
    resumePlay();
    hideOSD();    
}


function resumePlay()
{
    videoObj.execCmd("playback_continuePlay");
}


function noSubtitleMenu()
{	
    
    var htmlString = '<object class="class0" type="application/video"   id="myvideoObj" url="aaa" x=0 y=0 width="1280" height="720"></object>';
    htmlString += "<span  id = 'subtitleMenu0' style='position:absolute;z-index:5;left:900px;top:250px;width:280;height:48;color:#ffffff;font-size:40px;font-family:Arial;visibility:visible'>No Subtitle</span>";

    document.getElementById("div1").innerHTML = htmlString;
    document.getElementById("subtitleMenu0").style.backgroundColor = "#780850"; 
    	  
}


function noTrackAudioMenu()
{	
    
    var htmlString = '<object class="class0" type="application/video"   id="myvideoObj" url="aaa" x=0 y=0 width="1280" height="720"></object>';
    htmlString += "<span  id = 'trackAudioMenu0' style='position:absolute;z-index:5;left:100px;top:250px;width:380;height:48;color:#ffffff;font-size:40px;font-family:Arial;visibility:visible'>No Audio Track</span>";

    document.getElementById("div1").innerHTML = htmlString;
    document.getElementById("trackAudioMenu0").style.backgroundColor = "#780850"; 
    	  
}


function showSubtitleMenu(selectMenuIndex)
{
    
    var htmlString = '<object class="class0" type="application/video"   id="myvideoObj" url="aaa" x=0 y=0 width="1280" height="720"></object>';
    for(var i=0;i<subtitleItemNum;i++)
    {
        htmlString += "<span  id = 'subtitleMenu"+i+"' style='position:absolute;z-index:5;left:900px;top:"+(250+50*i)+"px;width:280;height:48;color:#ffffff;font-size:40px;font-family:Arial;visibility:visible'>";
        htmlString += videoObj.execCmd("playback_getSubInfo",i);
        htmlString += "</span>";
    }
    document.getElementById("div1").innerHTML = htmlString;
    
    for(var i=0;i<subtitleItemNum;i++)
    {
    	  var itemIndex = "subtitleMenu" + i;
    	  if(selectMenuIndex == i)
            document.getElementById(itemIndex).style.backgroundColor = "#780850"; 
        else
        	  document.getElementById(itemIndex).style.backgroundColor =  "#30d0bc";
    }
    	  
}


function showTrackAudioMenu(selectMenuIndex)
{
    
    var htmlString = '<object class="class0" type="application/video"   id="myvideoObj" url="aaa" x=0 y=0 width="1280" height="720"></object>';
    for(var i=0;i<trackAudioItemNum;i++)
    {
        htmlString += "<span  id = 'trackAudioMenu"+i+"' style='position:absolute;z-index:5;left:100px;top:"+(250+50*i)+"px;width:380;height:48;color:#ffffff;font-size:40px;font-family:Arial;visibility:visible'>";
        htmlString += videoObj.execCmd("playback_getAudioInfo",i);
        htmlString += "</span>";
    }
    document.getElementById("div1").innerHTML = htmlString;
    
    for(var i=0;i<trackAudioItemNum;i++)
    {
    	  var itemIndex = "trackAudioMenu" + i;
    	  if(selectMenuIndex == i)
            document.getElementById(itemIndex).style.backgroundColor = "#780850"; 
        else
        	  document.getElementById(itemIndex).style.backgroundColor =  "#30d0bc";
    }
    	  
}

function hideOSD()
{
    document.getElementById('img1').style.visibility = 'hidden';
    document.getElementById('bg1').style.visibility = 'hidden';
	  
    document.getElementById('img2').style.visibility = 'hidden';
    document.getElementById('bg2').style.visibility = 'hidden';
	  
    document.getElementById('img3').style.visibility = 'hidden';
    document.getElementById('bg3').style.visibility = 'hidden';
	  
	  
    document.getElementById('img4').style.visibility = 'hidden';
    document.getElementById('bg4').style.visibility = 'hidden';
	  
    document.getElementById('img5').style.visibility = 'hidden';
    document.getElementById('bg5').style.visibility = 'hidden';
	  
    document.getElementById('id2').style.visibility = 'hidden';

    document.getElementById('idspan').style.visibility = 'hidden';

    document.getElementById('id2').style.backgroundImage ='';
	  
    var htmlString = '<object class="class0" type="application/video"   id="myvideoObj" url="aaa" x=0 y=0 width="1280" height="720"></object>';
    document.getElementById("div1").innerHTML = htmlString;
}	


function showOSD()
{
    document.getElementById('img1').style.visibility = 'visible';
    document.getElementById('bg1').style.visibility = 'visible';
	  
    document.getElementById('img2').style.visibility = 'visible';
    document.getElementById('bg2').style.visibility = 'visible';
    document.getElementById('img3').style.visibility = 'visible';
    document.getElementById('bg3').style.visibility = 'visible';
	  
	  
    document.getElementById('img4').style.visibility = 'visible';
    document.getElementById('bg4').style.visibility = 'visible';
	  
    document.getElementById('img5').style.visibility = 'visible';
    document.getElementById('bg5').style.visibility = 'visible';
	  
    document.getElementById('id2').style.visibility = 'visible';

    document.getElementById('idspan').style.visibility = 'visible';
    document.getElementById('id2').style.backgroundImage = 'url(0902/web_movie_bg.png)';
    document.getElementById("div1").innerHTML = '<object class="class0" type="application/video"   id="myvideoObj" url="aaa" x=0 y=0 width="1280" height="462"></object>';
  
}


function subtitleMenuItemSelect(selectMenuIndex){
    for(var i=0;i<subtitleItemNum;i++)
    {
        var itemIndex = "subtitleMenu" + i;
        if(selectMenuIndex == i)
            document.getElementById(itemIndex).style.backgroundColor = "#780850"; 
        else
        	  document.getElementById(itemIndex).style.backgroundColor = "#30d0bc"; 
    } 
}


function trackAudioMenuItemSelect(selectMenuIndex){
    for(var i=0;i<trackAudioItemNum;i++)
    {
        var itemIndex = "trackAudioMenu" + i;
        if(selectMenuIndex == i)
            document.getElementById(itemIndex).style.backgroundColor = "#780850"; 
        else
        	  document.getElementById(itemIndex).style.backgroundColor = "#30d0bc"; 
    } 
}


</script>

</head>

<body width='100%' height='100%' onkeydown="whichButton(event)" onload="init()" onunload="onexit()">
	

<div id ='div1' style='position:absolute;z-index:-1;left:0px;top:0px;width:1280px;height:462px'>
<object class="class0" type="application/video"   id="myvideoObj" url="aaa" x=0 y=0 width="1280" height="462"></object>
</div>

<div class='class1' id = 'id2' style='position:absolute;z-index:4'>

<span id = 'idspan' style='z-index:5;position:absolute;left:180px;top:2px;border:1px;visibility:visible'>
<script>display('element1',0,1);</script>
</span>

<span id='timer' style='position:absolute;z-index:5;left:1124px;top:0px;'>
<p style='color:#000000;font-size:16px;font-family:Arial'></p>
</span>	

<span  style='position:absolute;z-index:5;left:180px;top:54px;visibility:visible'>
<a><img id='bg1' border=0 src="0902/web_movie_icon_left_.png" v:shapes="_x0000_s1043"></a>
</span>

<span  style='position:absolute;z-index:9;left:185px;top:73px;width:150px;height:85px;visibility:visible'>
<a><img id='img1' src="0902/loading.jpg" border=0  style='width:150px;height:85px;' v:shapes="_x0000_s1047"></a>
</span>

<span  style='position:absolute;z-index:5;left:351px;top:54px;visibility:visible'>
<a ><img id='bg2' border=0 src="0902/web_movie_icon_left_.png"  v:shapes="_x0000_s1044"></a>
</span>

<span  style='position:absolute;z-index:9;left:356px;top:73px;width:150px;height:85px;visibility:visible'>
<a><img id='img2' src="0902/loading.jpg" border=0  style='width:150px;height:85px;' v:shapes="_x0000_s1047"></a>
</span>

<span  style='position:absolute;z-index:5;left:522px;top:40px;visibility:visible'>
<a><img id='bg3' border=0 src="0902/web_movie_icon_focus_.png" v:shapes="_x0000_s1045"></a>
</span>

<span  style='position:absolute;z-index:9;left:546px;top:65px;width:200px;height:115px;visibility:visible'>
<a><img id='img3' src="0902/loading.jpg" border=0  style='width:200px;height:115px;' v:shapes="_x0000_s1047" ></a>
</span>

<span  style='position:absolute;z-index:5;left:781px;top:54px;visibility:visible'>
<a><img id='bg4' border=0 src="0902/web_movie_icon_right_.png" v:shapes="_x0000_s1046"></a>
</span>

<span  style='position:absolute;z-index:9;left:786px;top:73px;width:150px;height:85px;visibility:visible'>
<a><img id='img4' src="0902/loading.jpg" border=0  style='width:150px;height:85px;' v:shapes="_x0000_s1047"></a>
</span>

<span  style='position:absolute;z-index:5;left:953px;top:54px;visibility:visible'>
<a><img id='bg5' border=0  src="0902/web_movie_icon_right_.png" v:shapes="_x0000_s1047"></a>
</span>

<span  style='position:absolute;z-index:9;left:959px;top:73px;width:150px;height:85px;visibility:visible'>
<a><img id='img5' src="0902/loading.jpg" border=0  style='width:150px;height:85px;' v:shapes="_x0000_s1047"></a>
</span>

</div>

</body>

</html>
