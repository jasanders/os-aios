<?xml version='1.0' ?>
<rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/">
<bookmark> AceTrax </bookmark>

<script>
AceTrax_getFontRenderer("./Resource/font/DroidSans.ttf");
</script>

<mediaDisplay name=photoView 
	imageFocs=null
	imageParentFocus=null
	itemBackgroundColor = -1:-1:-1
	fontSize=12.6
	
	sideTopHeightPC=0
	
	verticalMenu=no
	menuColumnCount=7
	menuOffsetXPC = 5.23
	menuOffsetYPC = 17.6
	menuItemHeightPC = 5
	menuItemWidthPC = 12.81
	menuBorderColor = -1:-1:-1
	menuFontColor = 250:250:250
	drawMenuBorder = no
	menuBackgroundColor=-1:-1:-1
	drawMenuText=no
	
	drawItemBorder=no
	
	bottomYPC=100

	showHeader=no
	showDefaultInfo=no
	idleImageXPC=44.68
	idleImageYPC=91.38
	idleImageWidthPC=12.5
	idleImageHeightPC=2.08
	sliding=no
>

<!--Login Display-->
<text offsetYPC=8.12 offsetXPC=74.9 heightPC=5 widthPC=20 backgroundColor=-1:-1:-1 foregroundColor=255:255:255 align="right" fontSize=12 useBackgroundSurface=yes>
<script>
userlogin = AceTrax_IsLoginSTB();
if( userlogin == "true" ){
	text = AceTrax_getUserName();
}
else
{
	text = "";
}
</script>
</text>
<text offsetYPC=12.12 offsetXPC=74.9 heightPC=5 widthPC=20 backgroundColor=-1:-1:-1 foregroundColor=255:255:255 align="right" fontSize=12 useBackgroundSurface=yes>
<script>
if( userlogin == "true" ){
	balance  = AceTrax_getVoucherBalance();
	symbollist = AceTrax_getVoucherInfoList("currency");
	symbol = getStringArrayAt(symbollist,0);
	if(symbol == "GBP")
		text = "$[ACE_BALANCE]" +":" +" "+ "$[ACE_GBP]" + " "+ balance;
	else if(symbol == "EUR")
		text = "$[ACE_BALANCE]" +":" +" "+ "$[ACE_EURO]" +" "+ balance;
	else
		text = "$[ACE_BALANCE]" + ":" +" "+ balance + " "+symbol;
}
else
{
	text = "";
}
</script>
</text>

<resetViewArea>
<script>
resetViewArea;
</script>
</resetViewArea>

<centerHeightPC>
<script>
if (pagecontext == "browse")
{
	"78";
}
else if (pagecontext == "mymovies")
{
	"78";
}
else if (pagecontext == "displayVoucher")
{
	"78";
}
else if (pagecontext == "moviedetail")
{
	"12";
}
else
{
	"70";
}
</script>
</centerHeightPC>

<itemOffsetXPC>
<script>
if (pagecontext == "browse")
{
	"11.12";
}
else if (pagecontext == "mymovies")
{
	"4.67";
}
else if (pagecontext == "displayVoucher")
{
	"12.22";
}
else if (pagecontext == "moviedetail")
{
	"2.57";
}
else
{
	"15.23";
}
</script>
</itemOffsetXPC>

<itemOffsetYPC>
<script>
if (pagecontext == "browse")
{
	"31.53";
}
else if (pagecontext == "mymovies")
{
	"40";
}
else if (pagecontext == "displayVoucher")
{
	"40";
}
else if (pagecontext == "moviedetail")
{
	"85";
}
else
{
	"30.56";
}
</script>
</itemOffsetYPC>

<rowCount>
<script>
if (pagecontext == "browse")
{
	"7";
}
else if (pagecontext == "mymovies")
{
	"8";
}
else if (pagecontext == "displayVoucher")
{
	"8";
}
else if (pagecontext == "moviedetail")
{
	"1";
}
else
{
	"2";
}
</script>
</rowCount>

<columnCount>
<script>
if (pagecontext == "browse")
{
	"2";
}
else if (pagecontext == "moviedetail")
{
	"4";
}
else if (pagecontext == "mymovies")
{
	"1";
}
else if (pagecontext == "displayVoucher")
{
	"1";
}
else
{
	"6";
}
</script>
</columnCount>

<itemWidthPC>
<script>
if (pagecontext == "browse")
{
	"32.2";
}
else if (pagecontext == "mymovies")
{
	"87.52";
}
else if (pagecontext == "displayVoucher")
{
	"71.56";
}
else if (pagecontext == "moviedetail")
{
	"14.69";
}
else
{
	"10.16";
}
</script>
</itemWidthPC>

<itemHeightPC>
<script>
if (pagecontext == "browse")
{
	"6.11";
}
else if (pagecontext == "mymovies")
{
	"5.28";
}
else if (pagecontext == "displayVoucher")
{
	"5";
}
else if (pagecontext == "moviedetail")
{
	"7.22";
}
else
{
	"27.08";
}
</script>
</itemHeightPC>

<itemGapXPC>
<script>
if (pagecontext == "browse")
{
	"4.4";
}
else if (pagecontext == "moviedetail")
{
	"2.71";
}
else
{
	"1.44";
}
</script>
</itemGapXPC>

<itemGapYPC>
<script>
if (pagecontext == "browse")
{
	"0.4";
}
else if (pagecontext == "mymovies")
{
	"0.1";
}
else if (pagecontext == "displayVoucher")
{
	"0.1";
}
else
{
	"3.47";
}
</script>
</itemGapYPC>

<backgroundDisplay>
	<name>
	<script>
		if (pagecontext == "browse")
		{
			"ace_guide_bg_browse";
		}
		else if (pagecontext == "mymovies")
		{
			"ace_guide_bg_mymovie";
		}
		else
		{
			"ace_guide_bg";
		}
	</script>
	</name>
	<image offsetXPC=0 offsetYPC=0 widthPC=100 heightPC=100>
		<script>
		language = getLanguageType();
		print("current language is: ", language);
		if (language == "German")
		{
			"../image/p1_bg_GE.fsp";
		}
		else if (language == "French")
		{
			"../image/p1_bg_FR.fsp";
		}
		else if (language == "Italian")
		{
			"../image/p1_bg_IT.fsp";
		}
		else
		{
			"../image/p1_bg_EN.fsp";
		}
		</script>
	</image>
	<image offsetXPC=15.08 offsetYPC=27.78 heightPC=59.02>
		<widthPC>
		<script>
			if(pagecontext == "browse")
				"33.2";
			else
				"0";
		</script>
		</widthPC>
		<script>
		"../image/acetrax_genres_background.fsp";
		</script>
	</image>
	<image offsetXPC=51.80 offsetYPC=27.78 heightPC=59.02>
		<widthPC>
		<script>
			if(pagecontext == "browse")
				"33.2";
			else
				"0";
		</script>
		</widthPC>
		<script>
		"../image/acetrax_genres_background.fsp";
		</script>
	</image>
	<!-- my movie background -->
	<image offsetYPC=27.78 offsetXPC=5.47 heightPC=59.03>
	<widthPC>
	<script>
	if (pagecontext == "mymovies")
	{
		"89.3";
	}
	else
	{
		"0";
	}
	</script>
	</widthPC>
	<script>
	"../image/acetrax_my_movies_panel.fsp";
	</script>
	</image>
</backgroundDisplay>

<!-- text area for FAQ, TC, LostPin -->
<text offsetXPC=14.29 offsetYPC=29.17 widthPC=40 backgroundColor=-1:-1:-1 foregroundColor=250:250:250 fontSize=17 heightPC=12>
	<script>
		type = getenv("textOnlyType");
		if (pagecontext == "textonly")
		{
			if (type == "FAQ")
			{
				"$[ACE_FAQ]";
			}
			else if (type == "TC")
			{
				"T&amp;C";
			}
			else if (type == "PIN")
			{
				"$[ACE_LOST_PIN]";
			}
			else
			{
				null;
			}
		}
		else
		{
			null;
		}
	</script>
</text>
<text offsetXPC=14.29 offsetYPC=40 widthPC=70 backgroundColor=-1:-1:-1 foregroundColor=250:250:250 fontSize=12 heightPC=40 lines=8>
<multiPage>
<script>
if (pagecontext == "textonly")
{
	if (isInitialState == "yes")
	{
		resetMultiPage();
		isInitialState = "no";
	}
	"yes";
}
else
{
	"no";
}
</script>
</multiPage>

	<script>
		type = getenv("textOnlyType");
		if (pagecontext == "textonly")
		{
			if (type == "FAQ" || type == "TC" || type == "PIN")
 			{
				getEnv("texttoshow");
 			}
			else
			{
 				null;
 			}
		}
		else
		{
			null;
		}
	</script>
</text>

<!-- text area for FAQ, TC page index indicator -->
<text align=v_top offsetYPC=90.97 offsetXPC=46.5 widthPC=22 backgroundColor=-1:-1:-1 foregroundColor=117:117:117 useBackgroundSurface=yes fontSize=13>
<heightPC>
	<script>
		height = 0;
		type = getenv("textOnlyType");
		if (pagecontext == "textonly" &amp;&amp; (type == "FAQ" || type == "TC"))
		{
			height = 6;
		}
		height;
	</script>
</heightPC> 
<script>
	type = getenv("textOnlyType");
	if (pagecontext == "textonly" &amp;&amp; (type == "FAQ" || type == "TC"))
	{
		pageNumber = Add(pageindex1 , 1);
		fin = "";
		ret = isMultiPageReachEnd();
		if(ret == "1")
		{
			textReachEnd = 1;
			fin = "  ($[ACE_END])";
		}
		"$[ACE_PAGE]" + " " + pageNumber + fin;
	}
	else
	{
		null;
	}
</script>
</text>

<image offsetYPC=93.06 offsetXPC=15.625 heightPC=3.19>
<widthPC>
<script>
if (pagecontext == "textonly" &amp;&amp; type != "ACCOUNT" &amp;&amp; pageNumber &gt; 1)
{
	"2.03";
}
else
{
	"0";
}
</script>
</widthPC>
<script>
"../image/p2_Previous.fsp";
</script>
</image>
<image offsetYPC=93.06 offsetXPC=82.27 heightPC=3.19>
<widthPC>
<script>
if (pagecontext == "textonly" &amp;&amp; type != "ACCOUNT" &amp;&amp; textReachEnd != 1)
{
	"2.03";
}
else
{
	"0";
}
</script>
</widthPC>
<script>
"../image/p2_next.fsp";
</script>
</image>

<!-- text area for account info -->
<text offsetYPC=29.17 widthPC=100 backgroundColor=-1:-1:-1 foregroundColor=250:250:250 fontSize=20 heightPC=28 align="center">
	<script>
		if (pagecontext == "textonly" &amp;&amp; getenv("textOnlyType") == "ACCOUNT")
		{
			text = "$[ACE_MYACCOUNT]";
		}
		else
		{
			null;
		}
	</script>
</text>
<text offsetYPC=45 widthPC=100 backgroundColor=-1:-1:-1 foregroundColor=250:250:250 fontSize=14 heightPC=16 align="center">
	<script>
		if (pagecontext == "textonly" &amp;&amp; getenv("textOnlyType") == "ACCOUNT")
		{
			"$[ACE_DEVICE_REGISTERED_WITH_ID]";
		}
		else
		{
			null;
		}
	</script>
</text>
<text offsetYPC=58 widthPC=100 backgroundColor=-1:-1:-1 foregroundColor=232:137:28 fontSize=15 heightPC=16 align="center">
	<script>
		if (pagecontext == "textonly" &amp;&amp; getenv("textOnlyType") == "ACCOUNT")
		{
			getEnv("texttoshow");
		}
		else
		{
			null;
		}
	</script>
</text>

<!-- mymovies, reminder text: Movie Name, License Type, Remaining -->
<text offsetYPC=31.11 offsetXPC=7.50 heightPC=8 backgroundColor=-1:-1:-1 foregroundColor=154:154:154 fontSize=13 widthPC=20>
<script>
if (pagecontext == "mymovies")
{
	"$[ACE_MOVIE_NAME]";
}
else
{
	null;
}
</script>
</text>
<text offsetYPC=31.11 offsetXPC=47.97 heightPC=8 backgroundColor=-1:-1:-1 foregroundColor=214:214:214 fontSize=13 widthPC=20>
<script>
if (pagecontext == "mymovies")
{
	"$[ACE_LANGUAGE]";
}
else
{
	null;
}
</script>
</text>
<text offsetYPC=31.11 offsetXPC=68.78 heightPC=8 backgroundColor=-1:-1:-1 foregroundColor=214:214:214 fontSize=13 widthPC=20>
<script>
if (pagecontext == "mymovies")
{
	"$[ACE_LICENSE_TYPE]";
}
else
{
	null;
}
</script>
</text>
<text offsetYPC=31.11 offsetXPC=81.25 heightPC=8 backgroundColor=-1:-1:-1 foregroundColor=214:214:214 fontSize=13 widthPC=19>
<script>
if (pagecontext == "mymovies")
{
	"$[ACE_EXPIRES_IN]";
}
else
{
	null;
}
</script>
</text>



<!-- display voucher, type, amount, expiration -->
<text offsetYPC=22 offsetXPC=15 heightPC=20 backgroundColor=-1:-1:-1 foregroundColor=214:214:214 fontSize=14 widthPC=25>
<script>
if (pagecontext == "displayVoucher")
{
	"$[ACE_VOUCHERS]";
}
else
{
	null;
}
</script>
</text>
<text offsetYPC=33 offsetXPC=15.3 heightPC=8 backgroundColor=-1:-1:-1 foregroundColor=216:216:216 fontSize=13 widthPC=20>
<script>
if (pagecontext == "displayVoucher")
{
	"$[ACE_TYPE]";
}
else
{
	null;
}
</script>
</text>
<text offsetYPC=33 offsetXPC=49.5 heightPC=8 backgroundColor=-1:-1:-1 foregroundColor=216:216:216 fontSize=13 widthPC=20>
<script>
if (pagecontext == "displayVoucher")
{
	"$[ACE_AMOUNT]";
}
else
{
	null;
}
</script>
</text>
<text offsetYPC=33 offsetXPC=72.5 heightPC=8 backgroundColor=-1:-1:-1 foregroundColor=216:216:216 fontSize=13 widthPC=20>
<script>
if (pagecontext == "displayVoucher")
{
	"$[ACE_EXPIRES]";
}
else
{
	null;
}
</script>
</text>


<image offsetYPC=93.06 offsetXPC=5.47 heightPC=3.19>
<widthPC>
<script>
if (pagecontext == "mymovies")
{
	if(ListmyEpisode == "true")
		"0";
	else
		"2.03";
}
else if (pagecontext == "displayVoucher")
{
	"2.03";
}
else if (pagecontext == "moviedetail" || pagecontext == "textonly")
{
	"0";
}
else if(getEnv("categoryType") == "showmoviecategory")
{
	"0";
}
else
{
	"2.03";
}
</script>
</widthPC>
<script>
	"../image/p2_Previous.fsp";
</script>
</image>
<text align=v_top heightPC=6 backgroundColor=-1:-1:-1 foregroundColor=117:117:117 useBackgroundSurface=yes fontSize=12>
<offsetXPC>
<script>
	if(pagecontext == "moviedetail"){
		"8.47";
	}
	else
		"8.47";
</script>
</offsetXPC>
<offsetYPC>
<script>
	if(pagecontext == "moviedetail"){
		"93.06";
	}
	else
		"93.06";
</script>
</offsetYPC>
<widthPC>
<script>
if (pagecontext == "mymovies")
{
	if(ListmyEpisode == "true")
		"0";
	else
		"12";
}
else if (pagecontext == "displayVoucher")
{
	"12";
}
else if (pagecontext == "moviedetail" || pagecontext == "textonly" || getEnv("categoryType") == "showmoviecategory")
{
	"0";
}
else
{
	"12";
}
</script>
</widthPC>
<script>
"$[ACE_PREVIOUS]";
</script>
</text>

<image offsetYPC=93.06 offsetXPC=92.58 heightPC=3.19>
<widthPC>
<script>
if (pagecontext == "mymovies")
{
	if(ListmyEpisode == "true")
		"0";
	else
		"2.03";
}
else if (pagecontext == "displayVoucher")
{
	"2.03";
}
else if (pagecontext == "moviedetail" || pagecontext == "textonly")
{
	"0";
}
else if(getEnv("categoryType") == "showmoviecategory")
{
	"0";
}
else
{
	"2.03";
}
</script>
</widthPC>
<script>
	"../image/p2_next.fsp";
</script>
</image>
<text align=v_top redraw=yes heightPC=6 backgroundColor=-1:-1:-1 foregroundColor=117:117:117 useBackgroundSurface=yes fontSize=12>
<offsetXPC>
<script>
	nextwidth = getTextWidth("$[ACE_NEXT]",13)/1280 * 100;
	if(pagecontext == "moviedetail"){
		92.58 - nextwidth;
	}
	else
		92.58 - nextwidth;
</script>
</offsetXPC>
<offsetYPC>
<script>
	if(pagecontext == "moviedetail"){
		"93.06";
	}
	else
		"93.06";
</script>
</offsetYPC>
<widthPC>
<script>
if (pagecontext == "mymovies")
{
	if(ListmyEpisode == "true")
		"0";
	else
		nextwidth;
}
else if (pagecontext == "displayVoucher")
{
	nextwidth;
}
else if (pagecontext == "moviedetail" || pagecontext == "textonly" || getEnv("categoryType") == "showmoviecategory")
{
	"0";
}
else
{
	nextwidth;
}
</script>
</widthPC>
<script>
"$[ACE_NEXT]";
</script>
</text>

<text align=v_top redraw=yes offsetYPC=93.06 offsetXPC=46 widthPC=14 backgroundColor=-1:-1:-1 foregroundColor=117:117:117 useBackgroundSurface=yes fontSize=12>
<heightPC>
	<script>
		height = 6;
		if (pagecontext == "moviedetail" || pagecontext == "textonly")
		{
			height = 0;
		}
		height;
	</script>
</heightPC> 
<script>
	curpage = Add(pageindex , 1);
	if(totalpage == 0)
	{
		totalpage = 1;
	}
	if(getEnv("categoryType") == "showmoviecategory")
		Add(1,getFocusItemIndex()) + " $[ACE_OF] " + itemSize;
	else{
		if(pagecontext == "mymovies" &amp;&amp; ListmyEpisode == "true"){
			idx =  Add(episodestartidx , getFocusItemIndex());
			Add(1,idx) + " $[ACE_OF] " + episodecnt;
		}
		else
			"$[ACE_PAGE]" + " " +  curpage + " $[ACE_OF] " + totalpage;
	}

</script>
</text>


<text offsetYPC=24.31 offsetXPC=0 widthPC=100 redraw=yes useBackgroundSurface=yes>
<heightPC>
<script>
if (pagecontext == "mymovies")
{
	"0";
}
else if(pagecontext == "browse")
{
	"0";
}
else if (pagecontext == "displayVoucher")
{
	"0";
}
else if (pagecontext == "moviedetail")
{
	"0";
}
else
{
	"6";
}
</script>
</heightPC>
<script>
null;
</script>
</text>


<text align=v_top offsetYPC=25.22 heightPC=6 backgroundColor=-1:-1:-1 foregroundColor=255:255:255 useBackgroundSurface=yes redraw=yes fontSize=11.2>
<offsetXPC>
<script>
title = getStringArrayAt(cateNameArray, getFocusItemIndex());
g_textWidth = textWidth(title, "UTF8", 22);
w = Add(28, g_textWidth, "float");
g_offset = (1280-w)/2;
g_offset = g_offset/1280 * 100;

if (pagecontext != "mymovies" &amp;&amp; pagecontext != "displayVoucher")
{
	if (g_textWidth &lt; 82)
	{
		g_textOffset = Add(g_offset, 1.5, "float");
	}
	else
	{
		g_textOffset = Add(g_offset, 2.2, "float");
	}
}
else
{
	"0";
}
</script>
</offsetXPC>
<widthPC>
<script>
if (pagecontext == "mymovies")
{
	"0";
}
else if(pagecontext == "browse")
{
	"0";
}
else if (pagecontext == "displayVoucher")
{
	"0";
}
else if (pagecontext == "moviedetail")
{
	"0";
}
else
{
	g_textWidth/1280 * 100;
}
</script>
</widthPC>
<script>
getStringArrayAt(cateNameArray, getFocusItemIndex());
</script>
</text>


<!-- movie detail  down down-->
<image redraw=no offsetXPC=5.47 offsetYPC=34.72 widthPC=14.69>
<heightPC>
	<script>
		height = 0;
		if (pagecontext == "moviedetail")
		{
			height = 39.03;
		}
		height;
	</script>
</heightPC> 
<script>
	url = null;
	if (pagecontext == "moviedetail"){
		if(moviethumbnail!=null){
			url = convertSpaceInUrl(moviethumbnail);
		}
	}
	url;
</script>
</image>

<text useBackgroundSurface=yes offsetXPC=5.47 redraw=yes backgroundColor=-1:-1:-1 foregroundColor=255:255:255 heightPC=5.6 fontSize=15>
<widthPC>
	<script>
		width = 0;
		if (pagecontext == "moviedetail")
		{
			width = 66;
		}
		else if (getEnv("categoryType") == "showmymovies" &amp;&amp; ListmyEpisode == "true")
		{
			width = 66;
		}
		else if (getEnv("categoryType") == "showsearch")
		{
			width = 66;
		}
		width;
	</script>
</widthPC> 
<offsetYPC>
	<script>
		if(getEnv("categoryType") == "showsearch"){
			if (pagecontext == "moviedetail")
				"27.78";
			else
				"28";
		}
		else
			"27.78";
	</script>
</offsetYPC> 
<script>
if(getEnv("categoryType") == "showsearch"){
	if (pagecontext == "moviedetail")
		movietitle;
	else
		"$[ACE_SEARCH_RESULTS]:"+getEnv("searchkeyword");
}
else
	movietitle;
</script>
</text>

<image offsetXPC=3.72 offsetYPC=29.4 widthPC=1.6>
<heightPC>
	<script>
		height = 0;
		if (pagecontext == "mymovies" &amp;&amp; ListmyEpisode == "true")
		{
			height = 1.6;
		}
		height;
	</script>
</heightPC> 
<script>
	"../image/p3_left.fsp";
</script>
</image>

<text redraw=no useBackgroundSurface=yes align=left offsetXPC=65.23 offsetYPC=34.72 widthPC=34 backgroundColor=-1:-1:-1 foregroundColor=196:196:196 fontSize=13>
	<heightPC>
	<script>
		height = 0;
		if(pagecontext == "moviedetail"){
			height = 4;
		}
		height;
	</script>
	</heightPC> 
	<script>
		Ratingtext;
	</script>
</text>

<text redraw=no align=left  useBackgroundSurface=yes offsetXPC=65.23 offsetYPC=39.37 widthPC=20 backgroundColor=-1:-1:-1 foregroundColor=196:196:196 fontSize=13>
	<heightPC>
	<script>
		height = 0;
		if(pagecontext == "moviedetail"){
			height = 4;
		}
		height;
	</script>
	</heightPC> 
	<script>
		Runtimetext;
	</script>
</text>

<text redraw=no align=left useBackgroundSurface=yes offsetXPC=65.23 offsetYPC=44.02 widthPC=20 backgroundColor=-1:-1:-1 foregroundColor=196:196:196 fontSize=13>
	<heightPC>
	<script>
		height = 0;
		if(pagecontext == "moviedetail"){
			height = 4;
		}
		height;
	</script>
	</heightPC> 
	<script>
		yeartext;
	</script>
</text>

<text redraw=no align=left useBackgroundSurface=yes offsetXPC=65.23 offsetYPC=48.67 widthPC=20 backgroundColor=-1:-1:-1 foregroundColor=196:196:196 fontSize=13>
	<heightPC>
	<script>
		height = 0;
		if(pagecontext == "moviedetail"){
			height = 4;
		}
		height;
	</script>
	</heightPC> 
	<script>
		Sizetext;
	</script>
</text>

<text redraw=no align=left useBackgroundSurface=yes offsetXPC=65.23 offsetYPC=53.33 widthPC=9 backgroundColor=-1:-1:-1 foregroundColor=196:196:196 fontSize=13>
	<heightPC>
	<script>
		height = 0;
		if(pagecontext == "moviedetail"){
			height = 4;
		}
		height;
	</script>
	</heightPC> 
	<script>
		"$[ACE_LANGUAGE]: ";
	</script>
</text>

<!-- display language image, assume at most 4 languages -->
<image offsetXPC=74.77 offsetYPC=53.33 widthPC=3.2 redraw=no useBackgroundSurface=yes>
	<heightPC>
	<script>
		height = 0;
		if(pagecontext == "moviedetail"){
			height = 3.47;
		}
		height;
	</script>
	</heightPC> 
	<script>
		if (languageSize &gt; 0 &amp;&amp; languageInfo != null)
		{
			lang = getStringArrayAt(languageInfo, 0);
			if(lang == "French")
				lang = "France";
			languageSize = Add(languageSize, -1);
			"../image/" + lang + ".fsp";
		}
		else
		{
			null;
		}
	</script>
</image>
<image offsetXPC=79 offsetYPC=53.33 widthPC=3.2 redraw=no useBackgroundSurface=yes>
	<heightPC>
	<script>
		height = 0;
		if(pagecontext == "moviedetail"){
			height = 3.47;
		}
		height;
	</script>
	</heightPC> 
	<script>
		if (languageSize &gt; 0 &amp;&amp; languageInfo != null)
		{
			lang = getStringArrayAt(languageInfo, 1);
			if(lang == "French")
				lang = "France";
			languageSize = Add(languageSize, -1);
			"../image/" + lang + ".fsp";
		}
		else
		{
			null;
		}
	</script>
</image>
<image offsetXPC=83.23 offsetYPC=53.33 widthPC=3.2 redraw=no useBackgroundSurface=yes>
	<heightPC>
	<script>
		height = 0;
		if(pagecontext == "moviedetail"){
			height = 3.47;
		}
		height;
	</script>
	</heightPC> 
	<script>
		if (languageSize &gt; 0 &amp;&amp; languageInfo != null)
		{
			lang = getStringArrayAt(languageInfo, 2);
			if(lang == "French")
				lang = "France";
			languageSize = Add(languageSize, -1);
			"../image/" + lang + ".fsp";
		}
		else
		{
			null;
		}
	</script>
</image>
<image offsetXPC=87.46 offsetYPC=53.33 widthPC=3.2 redraw=no useBackgroundSurface=yes>
	<heightPC>
	<script>
		height = 0;
		if(pagecontext == "moviedetail"){
			height = 3.47;
		}
		height;
	</script>
	</heightPC> 
	<script>
		if (languageSize &gt; 0 &amp;&amp; languageInfo != null)
		{
			lang = getStringArrayAt(languageInfo, 3);
			if(lang == "French")
				lang = "France";
			languageSize = languageSize_backup;
			"../image/" + lang + ".fsp";
		}
		else
		{
			languageSize = languageSize_backup;
			null;
		}
	</script>
</image>


<text redraw=no align=left useBackgroundSurface=yes offsetXPC=65.23 offsetYPC=60.56 widthPC=30 backgroundColor=-1:-1:-1 foregroundColor=255:255:255 fontSize=13>
	<heightPC>
	<script>
		height = 0;
		if(pagecontext == "moviedetail"){
			height = 6;
		}
		height;
	</script>
	</heightPC> 
	<script>
		"$[ACE_DIRECTOR]: " + directortext;
	</script>
</text>

<text redraw=no align=v_top useBackgroundSurface=yes offsetXPC=65.23 offsetYPC=63.97 widthPC=29 backgroundColor=-1:-1:-1 foregroundColor=196:196:196 fontSize=13>
	<heightPC>
	<script>
		height = 0;
		if(pagecontext == "moviedetail"){
			height = 0;
		}
		height;
	</script>
	</heightPC> 
	<script>
		directortext;
	</script>
</text>

<text redraw=no align=left useBackgroundSurface=yes offsetXPC=64.53 offsetYPC=67.64 lines=3 widthPC=30 backgroundColor=-1:-1:-1 foregroundColor=255:255:255 fontSize=13>
	<heightPC>
	<script>
		height = 0;
		if(pagecontext == "moviedetail"){
			height = 11.94;
		}
		height;
	</script>
	</heightPC> 
	<script>
		"$[ACE_ACTORS]: "+actortext;
	</script>
</text>

<text redraw=no align=left useBackgroundSurface=yes offsetXPC=65.23 offsetYPC=67.97 widthPC=22 lines=3 backgroundColor=-1:-1:-1 foregroundColor=196:196:196 fontSize=13>
	<heightPC>
	<script>
		height = 0;
		if(pagecontext == "moviedetail"){
			height = 0;
		}
		height;
	</script>
	</heightPC> 
	<script>
		actortext;
	</script>
</text>

<previewWindow offsetXPC=23 offsetYPC=35 widthPC=37 heightPC=37>
<windowColor>
<script>
if (showPreviewWindow == "yes")
{
	showPreviewWindow = "no";
	"0:0:0";
}
else
{
	null;
}
</script>
</windowColor>
</previewWindow>

<progressBar offsetXPC=23 offsetYPC=72.92 widthPC=36.6 heightPC=9.2 useBackgroundSurface=yes>
<image offsetXPC=0 offsetYPC=0 widthPC=100 heightPC=20>
<script>
"../image/AceTrax_preview_bar_bg.fsp";
</script>
</image>
<image offsetXPC=1.6 offsetYPC=3 heightPC=16>
<widthPC>
<script>
vidProgress = getPlaybackStatus();
playElapsed = getStringArrayAt(vidProgress, 0);
playStatus = getStringArrayAt(vidProgress, 3);
playTotal = getStringArrayAt(vidProgress, 1);
if (playStatus == "2")
{
	width = (playElapsed/playTotal*96.8);
	if (width &gt;= 96.8)
		width = 96.8;
	width;
}
else
	"0";
</script>
</widthPC>
<script>
"../image/AceTrax_preview_bar_focus.fsp";
</script>
</image>
</progressBar>

<!-- movie synopis  down-->
<text offsetXPC=22.4 offsetYPC=33.9 widthPC=10 backgroundColor=-1:-1:-1 foregroundColor=182:182:182 fontSize=14>
	<heightPC>
	<script>
		height = 0;
		if(pagecontext == "moviedetail"){
			if(showsynopsis == "true"){
				height = 5;
			}
		}
		height;
	</script>
	</heightPC> 
	<script>
		"$[ACE_SYNOPSIS]:";
	</script>
</text>

<text offsetXPC=21.27 redraw=no offsetYPC=39.37 widthPC=41.1 backgroundColor=-1:-1:-1 foregroundColor=250:250:250 fontSize=13 lines=7>
<multiPage>
<script>
if (pagecontext == "moviedetail")
{
	if (isInitialState == "yes")
	{
		resetMultiPage();
		isInitialState = "no";
	}
	"yes";
}
else
{
	"no";
}
</script>
</multiPage>

	<heightPC>
	<script>
		height = 0;
		if(pagecontext == "moviedetail"){
			if(showsynopsis == "true"){
				height = 32.92;
			}
		}
		height;
	</script>
	</heightPC> 
	<script>
		text = null;
		if(pagecontext == "moviedetail"){
			if(showsynopsis == "true"){
				text = fullnews;
			}
		}
		text;
	</script>
</text>
<text offsetXPC=37.45 offsetYPC=76.39 widthPC=14.78 backgroundColor=-1:-1:-1 foregroundColor=250:250:250 fontSize=12>
	<heightPC>
	<script>
		height = 0;
		if(pagecontext == "moviedetail"){
			if(showsynopsis == "true"){
				height = 3;
			}
		}
		height;
	</script>
	</heightPC> 
	<script>
		if(pagecontext == "moviedetail"){
			if(showsynopsis == "true"){
				fin = "";
				ret = isMultiPageReachEnd();
				if(ret == "1")
				{
					textReachEnd = 1;
				}
				if(textReachEnd == 1)
				{
					fin = "  ($[ACE_END])";
				}
				pageNum = Add(pageindex1, 1);
				"$[ACE_PAGE]" + " " + pageNum  + fin;
			}
		}
		else{
			null;
		}
	</script>
</text>
<image offsetXPC=22.27 offsetYPC=76.39 widthPC=2.03 backgroundColor=-1:-1:-1 foregroundColor=250:250:250>
	<heightPC>
	<script>
		height = 0;
		if(pagecontext == "moviedetail"){
			if(showsynopsis == "true"){
				if(pageNum &gt; 1){
					height = "3.19";
				}
			}
		}
		height;
	</script>
	</heightPC> 
	<script>
		"../image/p2_Previous.fsp";
	</script>
</image>
<text offsetXPC=24.33 offsetYPC=76.39 widthPC=12 backgroundColor=-1:-1:-1 foregroundColor=250:250:250 fontSize=13>
	<heightPC>
	<script>
		height = 0;
		if(pagecontext == "moviedetail"){
			if(showsynopsis == "true"){
				if(pageNum &gt; 1){
					height = "4";
				}
			}
		}
		height;
	</script>
	</heightPC> 
	<script>
		"$[ACE_PREVIOUS]";
	</script>
</text>
<text offsetYPC=76.39 backgroundColor=-1:-1:-1 foregroundColor=250:250:250 fontSize=13>
	<offsetXPC>
	<script>
		nextwidth = getTextWidth("$[ACE_NEXT]",14)/1280 * 100;
		58.59 - nextwidth;
	</script>
	</offsetXPC>
	<widthPC>
	<script>
		nextwidth;
	</script>
	</widthPC>
	<heightPC>
	<script>
		height = 0;
		if(pagecontext == "moviedetail"){
			if(showsynopsis == "true"){
				if(textReachEnd != 1){
					height = "4";
				}
			}
		}
		height;
	</script>
	</heightPC> 
	<script>
		"$[ACE_NEXT]";
	</script>
</text>
<image offsetXPC=58.59 offsetYPC=76.39 widthPC=2.03 backgroundColor=-1:-1:-1 foregroundColor=250:250:250>
	<heightPC>
	<script>
		height = 0;
		if(pagecontext == "moviedetail"){
			if(showsynopsis == "true"){
				if(textReachEnd != 1){
					height = "3.19";
				}
			}
		}
		height;
	</script>
	</heightPC> 
	<script>
		"../image/p2_next.fsp";
	</script>
</image>
<!-- movie detail  upupup-->
<menuDisplay>
	<text offsetXPC=0 offsetYPC=0 widthPC=100 heightPC=100 useBackgroundSurface=yes/>
	<image offsetXPC=0 offsetYPC=0 widthPC=100 heightPC=100>
		<script>
			index1 = getFocusMenuIndex();
			index2 = getQueryMenuIndex();
			index3 = getEnv("guidemenuindex");
			context = getPageInfo("majorContext");
			image = null;
			if (context == "menu"){
				if(index2 == index3){
					if(index1 == index2){
						image = "../image/p1_item_focus.fsp";
					}
					else{
						image = "../image/p1_item_selected.fsp";
					}
				}
				else{
					if(index2 == index1){
						image = "../image/p1_item_focus.fsp";
					}
					else{
						image = "../image/p1_item_unfocus.fsp";
					}
				}
			}
			else{
				if(index2 == index3){
					image = "../image/p1_item_selected.fsp";
				}
				else{
					image = "../image/p1_item_unfocus.fsp";
				}
			}
			image;
		</script>
	</image>
	
	<text offsetXPC=2 offsetYPC=13 widthPC=96 heightPC=80 fontSize=12 backgroundColor=-1:-1:-1 align=center>
	<foregroundColor>
	<script>
	if (getFocusMenuIndex() == getQueryMenuIndex())
	{
		"255:255:255";
	}
	else
	{
		"255:255:255";
	}
	</script>
	</foregroundColor>
	<script>
		queryIndex = getQueryMenuIndex();
		getStringArrayAt(menutitleArray, queryIndex);
	</script>
	</text>
</menuDisplay>


<itemDisplay>
	<enlarge>
	<script>
	if (pagecontext == "moviedetail")
	{
		"yes";
	}
	else
	{
		"no";
	}
	</script>
	</enlarge>
	<image offsetYPC=0>
	<offsetXPC>
	<script>
		if(pagecontext == "moviedetail")
		{
			qindex = getQueryItemIndex();
			offset = 0;
			if (qindex &gt; 1)
			{
				offset = Add(qindex, -1) * 48.62;
			}
			offset;
		}
		else
		{
			"0";
		}
	</script>
	</offsetXPC>
	<widthPC>
	<script>
		if(pagecontext == "moviedetail")
		{
			if (getQueryItemIndex() == 0)
			{
				"100";
			}
			else
			{
				"148.62";
			}
		}
		else
			"100";
	</script>
	</widthPC>
	<heightPC>
	<script>
		"100";
	</script>
	</heightPC>
	<script>
	context = getPageInfo("majorContext");
	if (context == "menu"){
		if (pagecontext == "moviedetail")
		{
			if (pagecontext == "moviedetail"){
				if(getQueryItemIndex() == 0)
					"../image/acetrax_trailer_button_unfocus.fsp";
				else
					"../image/acetrax_buy_rent_button_unfocus.fsp";
			}
			else
				"../image/p3_unfocus.fsp";
		}
		else{
			if(pagecontext == "mymovies")
				"../image/acetrax_my_movies_selection_bar_unfocus.fsp";
			else
				null;
		}
	}
	else if (getDrawingItemState() == "focus")
	{
		if (pagecontext == "mymovies")
		{
			"../image/acetrax_my_movies_selection_bar.fsp";
		}
		else if (pagecontext == "displayVoucher")
		{
			null;
		}
		else if (pagecontext == "moviedetail")
		{
			if(getQueryItemIndex() == 0)
				"../image/acetrax_trailer_button_focus.fsp";
			else
				"../image/acetrax_buy_rent_button_focus.fsp";
		}
		else if (pagecontext == "browse")
		{
			"../image/acetrax_genres_selection-bar.fsp";
		}
		else
		{
			"../image/p1_movie_focus.fsp";
		}
	}
	else
	{
		if (pagecontext == "moviedetail")
		{
			if(getQueryItemIndex() == 0)
				"../image/acetrax_trailer_button_unfocus.fsp";
			else
				"../image/acetrax_buy_rent_button_unfocus.fsp";
		}
		else if (pagecontext == "displayVoucher")
		{
			null;
		}
		else if (pagecontext == "mymovies")
		{
			"../image/acetrax_my_movies_selection_bar_unfocus.fsp";
		}
		else if (pagecontext == "browse")
		{
			"../image/acetrax_genres_selection-bar_unfocus.fsp";
		}
		else{
			null;
		}
	}
	</script>
	</image>
	
	<image>
	<offsetXPC>
	<script>
	if (pagecontext == "browse")
	{
		"2.75";
	}
	else
	{
		"5.5";
	}
	</script>
	</offsetXPC>
	<offsetYPC>
	<script>
	if (pagecontext == "browse")
	{
		"7";
	}
	else
	{
		"3.2";
	}
	</script>
	</offsetYPC>
	<heightPC>
	<script>
	if (pagecontext == "browse")
	{
		"0";
	}
	else if (pagecontext == "moviedetail")
	{
		"0";
	}
	else
	{
		"94";
	}
	</script>
	</heightPC>
	<widthPC>
	<script>
	if (pagecontext == "browse")
	{
		"94.6";
	}
	else
	{
		"89";
	}
	</script>
	</widthPC>
	
	<script>
		if (pagecontext == "mymovies")
		{
			null;
		}
		else if (pagecontext == "displayVoucher")
		{
			null;
		}
		else if (pagecontext == "moviedetail")
		{
			null;
		}
		else
		{
			url = getStringArrayAt(cateFocusIconArray, -1);
			if(url != null)
			{
				url = convertSpaceInUrl(url);
			}
			url;
		}
	</script>
	</image>

	<text useBackgroundSurface=no backgroundColor=-1:-1:-1 foregroundColor=250:250:250 fontSize=11.2 widthPC=100>
	<align>
	<script>
		if(pagecontext == "browse")
			"left";
		else
			"center";
	</script>
	</align>
	<offsetXPC>
	<script>
		if(pagecontext == "browse")
		{
			"5";
		}
		else if (pagecontext == "moviedetail")
		{
			if (getQueryItemIndex() == 1)
			{
				"30";
			}
			else if (getQueryItemIndex() &gt;= 2)
			{
				"73";
			}
			else
			{
				"0";
			}
		}
		else
		{
			"0";
		}
	</script>
	</offsetXPC>
	<offsetYPC>
	<script>
	if (pagecontext == "moviedetail")
	{
		"0";
	}
	else if(pagecontext == "browse")
	{
		"0";
	}
	else
	{
		"90";
	}
	</script>
	</offsetYPC>
	<heightPC>
	<script>
	if (pagecontext == "browse")
	{
		"100";
	}
	else if (pagecontext == "moviedetail")
	{
		"100";
	}
	else
	{
		"0";
	}
	</script>
	</heightPC>
	<script>
	title = getStringArrayAt(cateNameArray, getQueryItemIndex());
	if (pagecontext == "moviedetail")
	{
		if (title == "$[ACE_RENT]")
		{
			if(rentsymbol == "CHF")
				title = title + " " + rentprice + " "+ rentsymbol;
			else
				title = title + " " + rentsymbol + " "+ rentprice;
		}
		else if (title == "$[ACE_BUY]")
		{
			if(buysymbol == "CHF")
				title = title + " " + buyprice + " "+ buysymbol;
			else
				title = title + " " + buysymbol + " "+ buyprice;
		}
	}
	title;
	</script>
	</text>
	
	<!-- for mymovies, title -->
	<text useBackgroundSurface=no backgroundColor=-1:-1:-1 foregroundColor=250:250:250 fontSize=11.2 align=left offsetXPC=1.50 heightPC=96 offsetYPC=2>
	<widthPC>
	<script>
	if (pagecontext == "mymovies")
	{
		"40";
	}
	else if (pagecontext == "moviedetail")
	{
		"0";
	}
	else
	{
		"0";
	}
	</script>
	</widthPC>
	<script>
		text = null;
		if(ListmyEpisode == "true"){
			acidx = Add(getQueryItemIndex(),episodestartidx);
			text = getStringArrayAt(titleArray, acidx);
		}
		else
			text = getStringArrayAt(titleArray, -1);
		text;
	</script>
	</text>
	
	<!-- for mymovies, language -->
	<image useBackgroundSurface=no backgroundColor=-1:-1:-1 foregroundColor=250:250:250 align=left offsetXPC=47.97 heightPC=60 offsetYPC=20>
	<widthPC>
	<script>
	if (pagecontext == "mymovies")
	{
		"3";
	}
	else
	{
		"0";
	}
	</script>
	</widthPC>
	<script>
		image = null;
		if(ListmyEpisode == "true"){
			acidx = Add(getQueryItemIndex(),episodestartidx);
			image = getStringArrayAt(languageArray, acidx);
		}
		else
			image = getStringArrayAt(languageArray, -1);
		image;
	</script>
	</image>
		
	<!-- for mymovies, license type -->
	<text useBackgroundSurface=no backgroundColor=-1:-1:-1 foregroundColor=250:250:250 fontSize=11.2 align=left offsetXPC=71.58 heightPC=96 offsetYPC=2>
	<widthPC>
	<script>
	if (pagecontext == "mymovies")
	{
		"16";
	}
	else
	{
		"0";
	}
	</script>
	</widthPC>
	<script>
		text = null;
		if(ListmyEpisode == "true"){
			acidx = Add(getQueryItemIndex(),episodestartidx);
			text = getStringArrayAt(LicenceArray, acidx);
		}
		else
			text = getStringArrayAt(LicenceArray, -1);
		text;
	</script>
	</text>
	
	<!-- for mymovies, remaining -->
	<text useBackgroundSurface=no backgroundColor=-1:-1:-1 foregroundColor=250:250:250 fontSize=11.2 align=left offsetXPC=85.55 heightPC=96 offsetYPC=2>
	<widthPC>
	<script>
	if (pagecontext == "mymovies")
	{
		"16";
	}
	else
	{
		"0";
	}
	</script>
	</widthPC>
	<script>
		text = null;
		if(ListmyEpisode == "true"){
			acidx = Add(getQueryItemIndex(),episodestartidx);
			text = getStringArrayAt(RemainingArray, acidx);
		}
		else
			text = getStringArrayAt(RemainingArray, -1);
		text;
	</script>
	</text>
	
	<!-- for mymovies, episode judgement -->
	<image offsetXPC=37.2 offsetYPC=32 widthPC=1.8 >
	<heightPC>
	<script>
		if (pagecontext == "mymovies")
		{
			if(ListmyEpisode == "false"){
				queryIndex = getQueryItemIndex();
				hasepisode = AceTrax_getPurchaseInfo(queryIndex, "included_purchases");
				if(hasepisode == 0)
					"0";
				else
					"36";
			}
			else
				"0";
		}
		else
		{
			"0";
		}
	</script>
	</heightPC>
	<script>
		 "../image/arrow.fsp";
	</script>
	</image>

	<!-- for displayVoucher, type -->
	<text useBackgroundSurface=no backgroundColor=-1:-1:-1 foregroundColor=117:117:117 fontSize=11.2 align=left offsetXPC=2 heightPC=96 offsetYPC=2>
	<widthPC>
	<script>
	if (pagecontext == "displayVoucher")
	{
		"22";
	}
	else
	{
		"0";
	}
	</script>
	</widthPC>
	<script>
	getStringArrayAt(typeArray, -1);
	</script>
	</text>
	
	<!-- for displayVoucher, amount -->
	<text useBackgroundSurface=no backgroundColor=-1:-1:-1 foregroundColor=117:117:117 fontSize=11.2 align=left offsetXPC=50 heightPC=96 offsetYPC=2>
	<widthPC>
	<script>
	if (pagecontext == "displayVoucher")
	{
		"22";
	}
	else
	{
		"0";
	}
	</script>
	</widthPC>
	<script>
		symbol = getStringArrayAt(currencyArray, -1);
		amount = getStringArrayAt(amountArray, -1);
		res = null;
		if(symbol == "GBP")
			res = "$[ACE_GBP]" + " " +amount;
		else if(symbol == "EUR")
			res = "$[ACE_EURO]" + " " + amount;
		else
			res = amount+" "+symbol;
		res;
	</script>
	</text>
	
	<!-- for displayVoucher, expiration -->
	<text useBackgroundSurface=no backgroundColor=-1:-1:-1 foregroundColor=117:117:117 fontSize=11.2 align=left offsetXPC=81.9 heightPC=96 offsetYPC=2>
	<widthPC>
	<script>
	if (pagecontext == "displayVoucher")
	{
		"22";
	}
	else
	{
		"0";
	}
	</script>
	</widthPC>
	<script>
	getStringArrayAt(expirationArray, -1);
	</script>
	</text>

</itemDisplay>


	<idleImage> ../image/laoding0001.fsp </idleImage>
	<idleImage> ../image/laoding0002.fsp </idleImage>
	<idleImage> ../image/laoding0003.fsp </idleImage>
	<idleImage> ../image/laoding0004.fsp </idleImage>
	<idleImage> ../image/laoding0005.fsp </idleImage>
	<idleImage> ../image/laoding0006.fsp </idleImage>
	<idleImage> ../image/laoding0007.fsp </idleImage>
	<idleImage> ../image/laoding0008.fsp </idleImage>
	<idleImage> ../image/laoding0009.fsp </idleImage>

<onUserInput>
userInput = currentUserInput();
focusIndex = getFocusItemIndex();
ret = "false";
status = getPageInfo("majorContext");
print("====== Ace_guide got user input ======: ", userInput, totalpage, pageindex);

if (userInput == "enter")
{
	/* avoid transition effect */
	if (status == "menu")
	{
		redrawDisplay("no");
	}
	else if (itemSize &lt;= 0)
	{
		ret = "true";
	}
}
else if (userInput == "return")
{
	if (status == "items")
	{
		categoryType = getEnv("categoryType");
		print("====== Ace_guide return... ======: ",pagecontext,categoryType,ListmyEpisode);
		if(pagecontext == "moviedetail"){
			playItemURL(-1, 8193);
			resetViewArea = "yes";
			cateNameArray = BackuptitleArray;
			cateFocusIconArray = BackupThumbArray;
			itemSize = BackupItemsize;
			pagecontext = Backuppagecontext;
			BackuptitleArray = null;
			BackupThumbArray = null;
			BackupItemsize = 0;
			Backuppagecontext = "other";
			setFocusItemIndex(0);
			redrawDisplay();
			unsetEnv("EpisodeNum");
			ret = "true";
		}
		else if (categoryType == "categorymoviebrowse")
		{
			setEnv("categoryType", "showmoviecategory");
			resetViewArea = "yes";
			pagecontext = "browse";
			
			AceTrax_updateCategoryBrowsing("category_movies", 0);
			cateNameArray=AceTrax_getCategoryInfoList("category_movies", "title");
			idArray=AceTrax_getCategoryInfoList("category_movies", "id");
			cateFocusIconArray=AceTrax_getCategoryInfoList("category_movies", "image");
			itemSize=AceTrax_getSizeByBannerCategoryName("category_movies");
			pageindex = 0;
			totalpage = 1;
			setFocusItemIndex(0);
			redrawDisplay();
			ret = "true";
		}
		else if(ListmyEpisode == "true"){
			titleArray = BackuptitleArray;
			languageArray = BackuplangArray;
			LicenceArray = BackuplicenArray;
			RemainingArray = BackupremainArray;
			itemSize = BackupItemsize;	
			totalpage = Backuptotalpage;
			pageindex = Backuppageindex;
			BackuptitleArray = null;
			BackuplangArray = null;
			BackuplicenArray = null;
			BackupremainArray = null;
			Backuppageindex = 0;
			Backuptotalpage = 0;
			BackupItemsize = 0;
			setFocusItemIndex(0);
			ListmyEpisode = "false";
			redrawDisplay();
			ret = "true";
		}
		else
		{
			/* avoid transition effect */
			redrawDisplay("no");
		}
	}
	else
	{
		/* avoid transition effect */
		redrawDisplay("no");
	}
}
else if (userInput == "left")
{
	index=getFocusItemIndex();
	if (status == "items"){
		categoryType = getEnv("categoryType");
		if(categoryType == "showmymovies"){
			if(ListmyEpisode == "true")
				postMessage("return");
			ret = "true";
		}
		else if(index == 0 &amp;&amp; pagecontext != "moviedetail")
		{
			if(totalpage &gt; 1)
			{
				if(pageindex &gt; 0)
				{
					pageindex = Minus(pageindex,1);
					resetViewArea = "yes";
					pagecontext = "other";
					categoryType = getEnv("categoryType");
					showIdle();
					if(categoryType == "showsearch"){
						keyword = getEnv("searchkeyword");
						AceTrax_updateSearch(keyword,pageindex);
						cateNameArray=AceTrax_getMovieInfoList("Search", "title");
						itemSize=AceTrax_getMovieSize("Search");
						cateFocusIconArray=AceTrax_getMovieInfoList("Search", "image");
					}
					else if(categoryType == "categorymoviebrowse"){
						movietype = getEnv("movietype");
						AceTrax_updateCategoryBrowsing(movietype,pageindex);
						cateNameArray=AceTrax_getMovieInfoList("CategoryBrowsing", "title");
						cateFocusIconArray=AceTrax_getMovieInfoList("CategoryBrowsing", "image");
						itemSize=AceTrax_getMovieSize("CategoryBrowsing");
					}
					setFocusItemIndex(0);
					redrawDisplay();
				}
			}
			ret = "true";
		}
	}
}
else if (userInput == "right")
{
	index=getFocusItemIndex();
	indexlimit = itemSize-1;
	index=getFocusItemIndex();
	if (status == "items"){
		categoryType = getEnv("categoryType");
		if(categoryType == "showmymovies"){
			hasepisode = AceTrax_getPurchaseInfo(index, "included_purchases");
			if(hasepisode != 0)
				postMessage("enter");
			ret = "true";
		}
		else if(pagecontext != "moviedetail" &amp;&amp; index == indexlimit)
		{
			if(totalpage &gt; 1)
			{
				pagelimit = totalpage - 1;
				if(pageindex &lt; pagelimit)
				{
					pageindex = Add(pageindex,1);
					resetViewArea = "yes";
					pagecontext = "other";
					categoryType = getEnv("categoryType");
					showIdle();
					if(categoryType == "showsearch"){
						keyword = getEnv("searchkeyword");
						AceTrax_updateSearch(keyword,pageindex);
						cateNameArray=AceTrax_getMovieInfoList("Search", "title");
						itemSize=AceTrax_getMovieSize("Search");
						cateFocusIconArray=AceTrax_getMovieInfoList("Search", "image");
					}
					else if(categoryType == "categorymoviebrowse"){
						movietype = getEnv("movietype");
						AceTrax_updateCategoryBrowsing(movietype,pageindex);
						cateNameArray=AceTrax_getMovieInfoList("CategoryBrowsing", "title");
						cateFocusIconArray=AceTrax_getMovieInfoList("CategoryBrowsing", "image");
						itemSize=AceTrax_getMovieSize("CategoryBrowsing");
					}
					setFocusItemIndex(0);
					redrawDisplay();
				}
			}
			ret = "true";
		}
	}
}
else if (userInput == "pageup")
{
	if(pagecontext == "moviedetail"){
		if(showsynopsis == "true"){
			print("textPageIndex , pageindex1 , imgCount , imgPageIndex  ", textPageIndex, pageindex1, imgCount, imgPageIndex);
			prePage = 0;
			if(textPageIndex == pageindex1)
			{
				if(textPageIndex &gt; 0)
				{
					ret = preMultiPage();
					printf("ret : ", ret);
					if(ret == "1")
					{
						textPageIndex = Minus(textPageIndex, 1);
						prePage = 1;
						textReachEnd = 0;
					}
				}
			}
			pageindex1 = Minus(pageindex1, prePage);
			redrawDisplay();
		}
	}
	else if (pagecontext == "textonly")
	{
		type = getenv("textOnlyType");
		if (type == "FAQ" || type == "TC")
		{
			prePage = 0;
			if(textPageIndex == pageindex1)
			{
				if(textPageIndex &gt; 0)
				{
					showIdle();
					ret = preMultiPage();
					printf("ret : ", ret);
					if (ret == "1")
					{
						textPageIndex = Minus(textPageIndex, 1);
						prePage = 1;
						textReachEnd = 0;
					}
				}
			}
			pageindex1 = Minus(pageindex1, prePage);
			redrawDisplay();
		}
	}
	else if(totalpage &gt; 1)
	{
		if(pageindex &gt; 0)
		{
			pageindex = Minus(pageindex,1);
			resetViewArea = "yes";
			pagecontext = "other";
			categoryType = getEnv("categoryType");
			showIdle();
			if(categoryType == "showsearch"){
				keyword = getEnv("searchkeyword");
				AceTrax_updateSearch(keyword,pageindex);
				cateNameArray=AceTrax_getMovieInfoList("Search", "title");
				itemSize=AceTrax_getMovieSize("Search");
				cateFocusIconArray=AceTrax_getMovieInfoList("Search", "image");
			}
			else if(categoryType == "categorymoviebrowse"){
				movietype = getEnv("movietype");
				AceTrax_updateCategoryBrowsing(movietype,pageindex);
				cateNameArray=AceTrax_getMovieInfoList("CategoryBrowsing", "title");
				cateFocusIconArray=AceTrax_getMovieInfoList("CategoryBrowsing", "image");
				itemSize=AceTrax_getMovieSize("CategoryBrowsing");
			}
			else if (categoryType == "showmymovies")
			{
				pagecontext = "mymovies";
				AceTrax_updateMyMovies(pageindex);
				itemSize = AceTrax_getPurchaseSize();
				titleArray = AceTrax_getPurchaseAssetsInfoList("title");
				languageArray = AceTrax_getPurchaseAssetsInfoList("language");
				LicenceArray = AceTrax_getPurchaseLicenseInfoList("type");
				RemainingArray = AceTrax_getPurchaseLicenseInfoList("expire");
			}
			setFocusItemIndex(0);
			redrawDisplay();
		}
	}
	ret = "true";

}
else if (userInput == "pagedown")
{
	if(pagecontext == "moviedetail"){
		if(showsynopsis == "true"){
			nextPage = 0;
			ret = nextMultiPage();
			if(ret == "1")
			{
				textPageIndex = Add(textPageIndex, 1);
				nextPage = 1;
			}
			pageindex1 = Add(pageindex1, nextPage);
			redrawDisplay();
		}
	}
	else if (pagecontext == "textonly")
	{
		type = getenv("textOnlyType");
		if (type == "FAQ" || type == "TC")
		{
			nextPage = 0;
			showIdle();
			ret = nextMultiPage();
			if(ret == "1")
			{
				textPageIndex = Add(textPageIndex, 1);
				nextPage = 1;
			}
			pageindex1 = Add(pageindex1, nextPage);
			redrawDisplay();
		}
	}
	else if(totalpage &gt; 1)
	{
		pagelimit = totalpage - 1;
		if(pageindex &lt; pagelimit)
		{
			pageindex = Add(pageindex,1);
			resetViewArea = "yes";
			pagecontext = "other";
			categoryType = getEnv("categoryType");
			showIdle();
			if(categoryType == "showsearch"){
				keyword = getEnv("searchkeyword");
				AceTrax_updateSearch(keyword,pageindex);
				cateNameArray=AceTrax_getMovieInfoList("Search", "title");
				itemSize=AceTrax_getMovieSize("Search");
				cateFocusIconArray=AceTrax_getMovieInfoList("Search", "image");
			}
			else if(categoryType == "categorymoviebrowse"){
				movietype = getEnv("movietype");
				AceTrax_updateCategoryBrowsing(movietype,pageindex);
				cateNameArray=AceTrax_getMovieInfoList("CategoryBrowsing", "title");
				cateFocusIconArray=AceTrax_getMovieInfoList("CategoryBrowsing", "image");
				itemSize=AceTrax_getMovieSize("CategoryBrowsing");
			}
			else if (categoryType == "showmymovies")
			{
				pagecontext = "mymovies";
				AceTrax_updateMyMovies(pageindex);
				itemSize = AceTrax_getPurchaseSize();
				titleArray = AceTrax_getPurchaseAssetsInfoList("title");
				languageArray = AceTrax_getPurchaseAssetsInfoList("language");
				LicenceArray = AceTrax_getPurchaseLicenseInfoList("type");
				RemainingArray = AceTrax_getPurchaseLicenseInfoList("expire");
			}
			setFocusItemIndex(0);
			redrawDisplay();
		}
	}
	ret = "true";
}
else if (userInput == "down")
{
	if (status == "menu")
	{
		menuindex = getEnv("guidemenuindex");
		setFocusMenuIndex(menuindex);
		if (itemSize &lt;= 0)
		{
			ret = "true";
		}
	}
	else if(ListmyEpisode == "true"){
		acidx = Add(episodestartidx , focusIndex);
		limit = episodecnt - 1;
		if(focusIndex == 7){
			if(acidx &lt; limit){
				episodestartidx = Add(episodestartidx , 1);
				showIdle();
				redrawDisplay();
			}
		}
	}
}
else if (userInput == "up")
{
	if (status == "items")
	{
		if(ListmyEpisode == "true"){
			if(focusIndex == 0 &amp;&amp; episodestartidx &gt; 0){
				episodestartidx = episodestartidx - 1;
				redrawDisplay();
				showIdle();
				ret = "true";
			}
		}
	}
}
else if (userInput == "video_completed" || userInput == "video_stop"|| userInput == "video_load_error")
{
	vidProgress = getPlaybackStatus();
	pstatus = getStringArrayAt(vidProgress, 3);
	ret = null;
	if(userInput == "video_stop" &amp;&amp; pstatus != 2){
		print("invalid stop command.......");
	}
	else{
	playItemURL(-1, 8193);
	redrawDisplay();
	showsynopsis = "true";
	pagecontext = "moviedetail";
	isInitialState = "yes";
	resetMultiPage();
	
	pageindex1 = 0;
	textPageIndex = 0;
	textPageCount = 0;
	textReachEnd = 0;
	totalItem = 0;
	
	/* need to reset array, the 1st item should display trailer */
	cateNameArray = null;
	setFocusItemIndex(0);
	itemSize=1;

	cateNameArray  = pushBackStringArray(cateNameArray, "$[ACE_TRAILER]");
	trailer = AceTrax_getMovieInfo(category,movieindex,"trailer");
	
	if( buyNumber &gt; 0 )
	{
		cateNameArray  = pushBackStringArray(cateNameArray, "$[ACE_BUY]");
		itemSize = Add(itemSize, 1);
	}
	if( rentNumber &gt; 0)
	{
		cateNameArray  = pushBackStringArray(cateNameArray, "$[ACE_RENT]");
		itemSize = Add(itemSize, 1);
	}
	if( HasEpisodes=="Series Season" )
	{
		cateNameArray  = pushBackStringArray(cateNameArray, "$[ACE_EPISODES]");
		itemSize = Add(itemSize, 1);
	}
	}
}
else if (userInput == "video_play")
{
	if (pauseVideo == "yes")
	{
		postMessage("video_pause");
		pauseVideo = "no";
		ret = "true";
	}
	else
	{
		vidProgress = getPlaybackStatus();
		pstatus = getStringArrayAt(vidProgress, 3);
		if(pstatus == 2)
		{
			postMessage("video_play");
			pauseVideo = "yes";
			ret = "true";
		}
	}
}
else if (userInput == "setup" || userInput == "guide")
{
	pauseVideo = "no";
}
print("====== Ace_guide userInput return value... ======:",ret);
ret;
</onUserInput>

</mediaDisplay>

<onExit>
unsetEnv("categoryType");
AceTrax_releaseFontRenderer();
AceTrax_End();
</onExit>

<onEnter>
	categoryType = getEnv("categoryType");
	showIdle();
	isInitialState = "yes";
	
	print("====== Ace_guide: onEnter ======", categoryType);
	if(categoryType != "showmymovies")
		ListmyEpisode = "false";
	needreturn = getEnv("Instantreturn");
	needreturn = "false";
	if(needreturn == "true"){
		postMessage("return");
		setEnv("Instantreturn","false");
	}
	if(getEnv("returnnochange")=="yes"){
		unsetEnv("returnnochange");
	}
	else if(categoryType == "shownewmovie"){
		AceTrax_updateGeneric("Top_NewRelease_Movies");
		cateNameArray=AceTrax_getMovieInfoList("Generic", "title");
		itemSize=AceTrax_getMovieSize("Generic");
		cateFocusIconArray=AceTrax_getMovieInfoList("Generic", "image");
		banerarray=AceTrax_getBannerImageURLList();
		banner=getStringArrayAt(banerarray , 0);
	}
	else if(categoryType == "showpopbuy"){
		resetViewArea = "yes";
		pagecontext = "popbuy";
		AceTrax_updateGeneric("Top_MostPopular_Buy");
		totalpage=AceTrax_getMoviePageSize("categoryBrowsing");
		cateNameArray=AceTrax_getMovieInfoList("Generic", "title");
		itemSize=AceTrax_getMovieSize("Generic");
		cateFocusIconArray=AceTrax_getMovieInfoList("Generic", "image");
		banerarray=AceTrax_getBannerImageURLList();
		banner=getStringArrayAt(banerarray , 0);
		if (totalpage == null)
			totalpage = 1;
	}
	else if(categoryType == "showpoprent"){
		resetViewArea = "yes";
		pagecontext = "poprent";
		AceTrax_updateGeneric("Top_MostPopular_Rent");
		totalpage=AceTrax_getMoviePageSize("categoryBrowsing");
		cateNameArray=AceTrax_getMovieInfoList("Generic", "title");
		itemSize=AceTrax_getMovieSize("Generic");
		cateFocusIconArray=AceTrax_getMovieInfoList("Generic", "image");
		banerarray=AceTrax_getBannerImageURLList();
		banner=getStringArrayAt(banerarray , 0);
		if (totalpage == null)
			totalpage = 1;
	}
	else if(categoryType == "showmymovies"){
		setEnv("guidemenuindex", "4");
		showIdle();
		if(ListmyEpisode == "true"){
			print("do nothing.....");
		}
		else{
			if(getEnv("backfromplay") == "yes"){
				unsetEnv("backfromplay");
			}
			else{
				AceTrax_updateMyMovies(0);
				print("enter ace guide my movie page............");
				pagecontext = "mymovies";
				resetViewArea = "yes";
				setEnv("categoryType","showmymovies");
				
				itemSize = AceTrax_getPurchaseSize();
				totalpage = AceTrax_getMoviePageSize("mymovies");
				print("======> items in my movies: ", itemSize);
				print("======> totalpage in my movies: ", totalpage);
				if (totalpage != null)
				{
					pageindex = 0;
					titleArray = AceTrax_getPurchaseAssetsInfoList("title");
					languageArray = AceTrax_getPurchaseAssetsInfoList("language");
					LicenceArray = AceTrax_getPurchaseLicenseInfoList("type");
					RemainingArray = AceTrax_getPurchaseLicenseInfoList("expire");
					setFocusItemIndex(0);
					redrawDisplay();
				}
			}
		}
	}
	else if(categoryType == "showtextonly"){
		setEnv("guidemenuindex", "5");
		showIdle();
		pagecontext = "textonly";
		resetViewArea = "yes";
		itemSize = 0;
		totalpage = 1;
		fullnews = getEnv("texttoshow");
		pageindex1 = 0;
		textPageIndex = 0;
		textPageCount = 0;
		textReachEnd = 0;
		totalItem = 0;
		pageindex = 0;
		cateNameArray = null;
		redrawDisplay();
	}
	else if (categoryType == "displayVoucher")
	{
		showIdle();
		setEnv("guidemenuindex", "5");
		
		AceTrax_updateGetUserVouchers();
		itemSize = AceTrax_getVoucherSize();
		if (itemSize &gt; 0)
		{
			pagecontext = "displayVoucher";
			resetViewArea = "yes";
			pageindex = 0;
			typeArray = AceTrax_getVoucherInfoList("is_topup");
			amountArray = AceTrax_getVoucherInfoList("price");
			currencyArray = AceTrax_getVoucherInfoList("currency");
			expirationArray = AceTrax_getVoucherInfoList("expiration");
			setFocusItemIndex(0);
		}
		redrawDisplay();
	}
	
	redirect = getEnv("redirect");
	if(redirect == "yes")
	{
		setRefreshTime(50);
	}
	context = getPageInfo("majorContext");
	if (context == "menu" &amp;&amp; redirect != "yes")
	{
		postMessage("down");
	}
</onEnter>

<script>
	pagecontext = "other";
	BackuptitleArray = null;
	detailArray = null;
	episodesArray = null;
	episodestartidx = 0;
	episodecnt = 0;
	detailsize = 0;
	BackuplangArray = null;
	BackuplicenArray = null;
	BackupremainArray = null;
	BackupThumbArray = null;
	Backupitemindex = 0;
	Backuppageindex = 0;
	Backuptotalpage = 0;
	BackupItemsize = 0;
	Backuppagecontext = "other";
	ListmyEpisode = "false";
	resetViewArea = "no";
	g_textWidth = 0;
	g_offset = 0;
	print("load ace guide script......");
	unsetEnv("redirect");
	unsetEnv("redirecturl");
	categoryType=getEnv("categoryType");
	showsynopsis = "false";
	movietitle = null;
	showIdle();
	AceTrax_Start();
	ff = AceTrax_getSizeByBannerCategoryName("category_movies");
	print("try to detect network......   category size:   ", ff);
	if(ff &lt; 0 || ff == 0){
		setEnv("errormsg","$[ACE_NETWORK_ERROR]");
		doModalRss("Ace_genericError.rss");
		postMessage("return");
	}
	setEnv("categoryType","shownewmovie");
	setEnv("guidemenuindex","0");

	index = getEnv("guidemenuindex");
	setFocusItemIndex(0);
	setFocusMenuIndex(index);
	menutitleArray  = pushBackStringArray(menutitleArray, "$[ACE_NEW_RELEASES]");
	menutitleArray  = pushBackStringArray(menutitleArray, "$[ACE_MOST_POPULAR]");
	menutitleArray  = pushBackStringArray(menutitleArray, "$[ACE_BROWSE]");
	/* FIXME: $[SEARCH] will output Search because multilingual support */
	menutitleArray  = pushBackStringArray(menutitleArray, "$[ACE_SEARCH]");
	menutitleArray  = pushBackStringArray(menutitleArray, "$[ACE_MY_MOVIES]");
	menutitleArray  = pushBackStringArray(menutitleArray, "$[ACE_ACCOUNT]");
	menutitleArray  = pushBackStringArray(menutitleArray, "$[ACE_ADULT]");
	totalpage=1;
	pageindex=0;
	redrawDisplay();
</script>

<onRefresh>
	vidProgress = getPlaybackStatus();
	pstatus = getStringArrayAt(vidProgress, 3);
	ret = null;
	if(pstatus == 2)
	{
		updatePlaybackProgress(vidProgress, "mediaDisplay", "progressBar");
	}
	else
	{
		redirect = getEnv("redirect");
		if(redirect == "yes"){
			url = getEnv("redirecturl");
			unsetEnv("redirect");
			unsetEnv("redirecturl");
			print("redirect from guide to ",url);
			
			result = doModalRss(url);
			if (result == "activateVoucherDone")
			{
				/* display voucher list in guide page */		
				showIdle();
				setEnv("guidemenuindex", "5");
				AceTrax_updateGetUserVouchers();
				itemSize = AceTrax_getVoucherSize();
				if (itemSize &gt; 0)
				{
					pagecontext = "displayVoucher";
					resetViewArea = "yes";
					pageindex = 0;
					typeArray = AceTrax_getVoucherInfoList("is_topup");
					amountArray = AceTrax_getVoucherInfoList("price");
					currencyArray = AceTrax_getVoucherInfoList("currency");
					expirationArray = AceTrax_getVoucherInfoList("expiration");
					setFocusItemIndex(0);
					postMessage("down");
					redrawDisplay();
				}
				else
				{
					print("?????? no voucher list found ??????");
				}
			}
			else if(result == "showtext"){
				setEnv("guidemenuindex", "5");
				showIdle();
				pagecontext = "textonly";
				resetViewArea = "yes";
				itemSize = 0;
				totalpage = 1;
				fullnews = getEnv("texttoshow");
				pageindex1 = 0;
				textPageIndex = 0;
				textPageCount = 0;
				textReachEnd = 0;
				totalItem = 0;
				pageindex = 0;
				cateNameArray = null;
				redrawDisplay();
			}
			else if (result == "returnFromCreatePin" || result == "returnFromCreateAccount")
			{
				restoreOsdArea("yes");
			}
			else if(getEnv("showvouchers") == "yes"){
				unsetEnv("showvouchers");
				setEnv("categoryType", "displayVoucher");
				setEnv("textOnlyType", "VOUCHER");
				showIdle();
				setEnv("guidemenuindex", "5");
				AceTrax_updateGetUserVouchers();
				itemSize = AceTrax_getVoucherSize();
				if (itemSize &gt; 0)
				{
					pagecontext = "displayVoucher";
					resetViewArea = "yes";
					pageindex = 0;
					typeArray = AceTrax_getVoucherInfoList("is_topup");
					amountArray = AceTrax_getVoucherInfoList("price");
					currencyArray = AceTrax_getVoucherInfoList("currency");
					expirationArray = AceTrax_getVoucherInfoList("expiration");
					setFocusItemIndex(0);
				}
				redrawDisplay();
			}
		}
		redirect = getEnv("redirect");
		print("=============== refresh ===============", redirect);
		if(redirect == "yes")
		{
			setRefreshTime(50);
		}
		else
		{
			if (pstatus == 0)
			{
				setRefreshTime(-1);
			}
		}
	}
	ret;
</onRefresh>

<item_template>
<onClick>
nexturl = null;
showIdle();
setRefreshTime(-1);
playItemURL(-1, 8193);
categoryType=getEnv("categoryType");
print("====== Ace_guide: onClick ======", categoryType);
if(categoryType == "showmoviecategory")
{
	setEnv("categoryType", "categorymoviebrowse");
	resetViewArea = "yes";
	pagecontext = "other";
	movietype = getStringArrayAt(idArray , -1);	
	setEnv("movietype",movietype);
	AceTrax_updateCategoryBrowsing(movietype,0);
	totalpage=AceTrax_getMoviePageSize("categoryBrowsing");
	pageindex = 0;
	cateNameArray=AceTrax_getMovieInfoList("CategoryBrowsing", "title");
	cateFocusIconArray=AceTrax_getMovieInfoList("CategoryBrowsing", "image");
	itemSize=AceTrax_getMovieSize("CategoryBrowsing");
	banner=getStringArrayAt(banerarray , 3);
	setItemFocus(0);
}
else if (categoryType == "showmymovies")
{
	index = getFocusItemIndex();
	print("................0000000000,",index,ListmyEpisode);
	if(ListmyEpisode == "false"){
		hasepisode = AceTrax_getPurchaseInfo(index, "included_purchases"); 
		if(hasepisode == 0){
			purchaseId = AceTrax_getPurchaseInfo(index, "purchase_id");
			AceTrax_updateGetMovieNoRH(purchaseId);
			playurl = AceTrax_getFilename();
			print("====== Ace_guide: to play ======",index,playurl);
			setEnv("playmovie",playurl);
			setEnv("backfromplay","yes");
			nexturl = "Ace_playmovie.rss";
		}
		else{
			ListmyEpisode = "true";
			BackuptitleArray = titleArray;
			BackuplangArray = languageArray;
			BackuplicenArray = LicenceArray;
			BackupremainArray = RemainingArray;
			Backupitemindex = index;
			BackupItemsize = itemSize;
			Backuptotalpage = totalpage;
			Backuppageindex = pageindex;
			movietitle=getStringArrayAt(titleArray , index);
			titleArray = AceTrax_getPurchaseEpisodeAssetsInfoList(index, "title");
			languageArray = AceTrax_getPurchaseEpisodeAssetsInfoList(index, "language");
			LicenceArray = AceTrax_getPurchaseEpisodeLicenseInfoList(index, "type");
			RemainingArray = AceTrax_getPurchaseEpisodeLicenseInfoList(index, "expire");
			episodecnt = AceTrax_getPurchaseEpisodeSize(index);
			episodestartidx = 0;
			if(episodecnt &gt; 8)
				itemSize = 8;
			else
				itemSize = episodecnt;
			print("Purchase Episode Size is ", itemSize);
			totalpage = 1;
			pageindex = 0;
			redrawDisplay();
			setItemFocus(0);
		}
	}
	else{
		aceidx = Add(index,episodestartidx);
		purchaseId = AceTrax_getPurchaseEpisodeInfo(Backupitemindex, aceidx, "purchase_id");
		AceTrax_updateGetMovieNoRH(purchaseId);
		playurl = AceTrax_getFilename();
		print("====== Ace_guide: onClick ======",aceidx,playurl);
		setEnv("playmovie",playurl);
		detailArray = cateNameArray;
		detailsize = itemSize;
		nexturl = "Ace_playmovie.rss";	
	}	

}
else
{
	funcindex = getFocusItemIndex();
	itemtitle = getStringArrayAt(cateNameArray , funcindex);
	selectionArray = getItemInfoArray("title");
	print("select array:",selectionArray,itemtitle);
	if(pagecontext == "moviedetail"){
		if(funcindex== 0){
			 /*trailer or synopsis*/
			cateNameArray = null;
			setFocusItemIndex(0);
			itemSize=1;
			if(showsynopsis == "false"){
				showsynopsis = "true";
				cateNameArray  = pushBackStringArray(cateNameArray, "$[ACE_TRAILER]");
				
				resetMultiPage();	
				pageindex1 = 0;
				textPageIndex = 0;
				textPageCount = 0;
				textReachEnd = 0;
				totalItem = 0;
			}else{
				showsynopsis = "false";
				cateNameArray  = pushBackStringArray(cateNameArray, "$[ACE_SYNOPSIS]");
				trailer = AceTrax_getMovieInfo(category,movieindex,"trailer");
				print("trailer:",category,trailer);
				showIdle();
				playItemURL(trailer, 0, "mediaDisplay", "previewWindow");
				/* this flag incidates how to handle play key */
				pauseVideo = "yes";
				setRefreshTime(1000);
				showPreviewWindow = "yes";
			}
			if( buyNumber &gt; 0 )
			{
				cateNameArray  = pushBackStringArray(cateNameArray, "$[ACE_BUY]");
				itemSize = Add(itemSize, 1);
			}
			if( rentNumber &gt; 0)
			{
				cateNameArray  = pushBackStringArray(cateNameArray, "$[ACE_RENT]");
				itemSize = Add(itemSize, 1);
			}
			if( HasEpisodes=="Series Season" )
			{
				cateNameArray  = pushBackStringArray(cateNameArray, "$[ACE_EPISODES]");
				itemSize = Add(itemSize, 1);
			}
		}
		else if(funcindex == 1 &amp;&amp; buyNumber  &gt; 0){
			/*buy*/
			registered = AceTrax_IsRegister();
			if (registered != "true")
			{
				doModalRss("Ace_purchasenodevice.rss");
				if(getEnv("Action") == "Register"){
					unsetEnv("categoryType");
					nexturl = "Ace_myaccount.rss";
				}
			}
			else
			{
				nexturl = null;
				setEnv("movieLanguage",buylang);
				setEnv("movePrice",buyprice);
				setEnv("movieTitle",movietitle);
				setEnv("moveSize",buySize);
				setEnv("symbol",buysymbol);
				doModalRss("Ace_purchaseask.rss");
				Ispurchase = getEnv("IsPurchase");
				if(Ispurchase == "true")
				{
					pinnumber = getEnv("pinnumber");
					print("==================buy movie,",pinnumber);
					if(pinnumber != null){
						showIdle();
						languechosen = getEnv("languageidx");
						offerContentID = AceTrax_getMovieResourceBuyorRentInfo(category,movieindex,"buy",languechosen,"offer_id");
						currency = AceTrax_getMovieResourceBuyorRentInfo(category,movieindex,"buy",languechosen,"currency");
						assetContentID = AceTrax_getMovieInfo(category,movieindex,"content_id");
						assetName = AceTrax_getMovieInfo(category,movieindex,"title");
						purchaseID = AceTrax_doPayment(pinnumber,offerContentID,buyprice,assetContentID,assetName,currency,"buy","0");
						if(getStringArrayAt(purchaseID,0) != "false"){
							AceTrax_updateGetMovieNoRH(purchaseID);
							playurl = AceTrax_getFilename();
							doModalRss("Ace_purchasefinish.rss");
							Action = getEnv("Action");
							if(Action == "Play"){
								detailArray = cateNameArray;
								detailsize = itemSize;
								setEnv("playmovie",playurl);
								nexturl = "Ace_playmovie.rss";
							}
							if(Action == "Download"){
								print("download...............start........");
							}
						}
						else{
							if(getStringArrayAt(purchaseID,1)!=null)
								setEnv("errormsg",getStringArrayAt(purchaseID,1));
							else
								setEnv("errormsg","$[ACE_PURCHASE_FAIL]");
							setEnv("showTitle","yes");
							setEnv("showIcon","yes");
							doModalRss("Ace_genericError.rss");
							redrawDisplay();
						}
					}
					else{
						setEnv("errormsg","$[ACE_INVALID_PIN]");
						setEnv("showTitle","yes");
						setEnv("showIcon","yes");
						doModalRss("Ace_genericError.rss");
						redrawDisplay();
					}
				}
				else{
					setEnv("errormsg","$[ACE_PAYMENT_CANCELED]");
					setEnv("showTitle","yes");
					setEnv("showIcon","yes");
					/* doModalRss("Ace_genericError.rss"); */
					redrawDisplay();
				}
			}
		}
		else if(itemtitle == "$[ACE_RENT]"){
			/*rent*/
			registered = AceTrax_IsRegister();
			if (registered != "true")
			{
				doModalRss("Ace_purchasenodevice.rss");
				if(getEnv("Action") == "Register"){
					unsetEnv("categoryType");
					nexturl = "Ace_myaccount.rss";
				}
			}
			else
			{
				nexturl = null;
				setEnv("movieLanguage",rentlang);
				setEnv("movePrice",rentprice);
				setEnv("movieTitle",movietitle);
				setEnv("moveSize",rentSize);
				setEnv("symbol",rentsymbol);
				doModalRss("Ace_purchaseask.rss");
				Ispurchase = getEnv("IsPurchase");
				if(Ispurchase == "true")
				{
					pinnumber = getEnv("pinnumber");
					print("==================rent movie,",pinnumber);
					if(pinnumber != null){
						showIdle();
						languechosen = getEnv("languageidx");
						offerContentID = AceTrax_getMovieResourceBuyorRentInfo(category,movieindex,"rent",languechosen,"offer_id");
						currency = AceTrax_getMovieResourceBuyorRentInfo(category,movieindex,"rent",languechosen,"currency");
						assetContentID = AceTrax_getMovieInfo(category,movieindex,"content_id");
						assetName = AceTrax_getMovieInfo(category,movieindex,"title");
						purchaseID = AceTrax_doPayment(pinnumber,offerContentID,rentprice,assetContentID,assetName,currency,"rent","0");
						if(getStringArrayAt(purchaseID,0) != "false"){
							AceTrax_updateGetMovieNoRH(purchaseID);
							playurl = AceTrax_getFilename();
							if( HasEpisodes=="Series Season" )
								setEnv("browseepisode","yes");
							else
								setEnv("browseepisode","no");
							doModalRss("Ace_purchasefinish.rss");
							Action = getEnv("Action");
							if(Action == "Play"){
								if( HasEpisodes=="Series Season" ){
									setEnv("episodelist",AceTrax_getPaymentPurchaseInfoList("title"));
									setEnv("episodenumber",AceTrax_getMovieResourceEpisodesSize());
									setEnv("purchaseIDlist",AceTrax_getPaymentPurchaseInfoList("purchase_id"));
									unsetEnv("Acetion");
									doModalRss("Ace_episodelist.rss");
								}
								else{
									setEnv("playmovie",playurl);
									nexturl = "Ace_playmovie.rss";
								}
							}
							if(Action == "Download"){
								print("download...............start........");
							}
						}
						else{
							print("===========,",getStringArrayAt(purchaseID,1));
							if(getStringArrayAt(purchaseID,1)!=null)
								setEnv("errormsg",getStringArrayAt(purchaseID,1));
							else
								setEnv("errormsg","$[ACE_PURCHASE_FAIL]");
							setEnv("showTitle","yes");
							doModalRss("Ace_genericError.rss");
							redrawDisplay();
						}
					}
					else{
						setEnv("errormsg","$[ACE_INVALID_PIN]");
						setEnv("showTitle","yes");
						doModalRss("Ace_genericError.rss");
						redrawDisplay();
					}
				}
				else{
					setEnv("errormsg","$[ACE_PAYMENT_CANCELED]");
					setEnv("showTitle","yes");
					/* doModalRss("Ace_genericError.rss"); */
					redrawDisplay();
				}
			}
		}
		else if( HasEpisodes=="Series Season" ){
			setEnv("EpisodeRelease",year);
			setEnv("EpisodeDirector",directortext);
			setEnv("EpisodeBuy",buyNumber);
			setEnv("EpisodeRent",rentNumber);
			setEnv("EpisodeActor",actortext);
			setEnv("EpisodeLang",languageInfo);
			setEnv("EpisodeLangsize",languageSize);
			setEnv("EpisodeSynop",fullnews);
			setEnv("EpisodeThumbnail",moviethumbnail);
			setEnv("movieTitle",movietitle);
			doModalRss("Ace_Tvseason.rss");
			/*try to enter my movies after movie purchase success*/
			if(getEnv("tobrowseepisode")=="yes"){
				unsetEnv("tobrowseepisode");
				setEnv("guidemenuindex", "4");
				pagecontext = "mymovies";
				resetViewArea = "yes";
				setEnv("categoryType","showmymovies");
				showIdle();
				AceTrax_updateMyMovies(0);
				ListmyEpisode = "true";
				BackuptitleArray = AceTrax_getPurchaseAssetsInfoList("title");
				BackuplangArray = AceTrax_getPurchaseAssetsInfoList("language");
				BackuplicenArray = AceTrax_getPurchaseLicenseInfoList("type");
				BackupremainArray = AceTrax_getPurchaseLicenseInfoList("expire");
				Backupitemindex = 0;
				BackupItemsize = AceTrax_getPurchaseSize();
				Backuptotalpage = AceTrax_getMoviePageSize("mymovies");
				Backuppageindex = 0;
				movietitle=getStringArrayAt(BackuptitleArray , 0);
				titleArray = AceTrax_getPurchaseEpisodeAssetsInfoList(0, "title");
				languageArray = AceTrax_getPurchaseEpisodeAssetsInfoList(0, "language");
				LicenceArray = AceTrax_getPurchaseEpisodeLicenseInfoList(0, "type");
				RemainingArray = AceTrax_getPurchaseEpisodeLicenseInfoList(0, "expire");
				episodecnt = AceTrax_getPurchaseEpisodeSize(0);
				episodestartidx = 0;
				if(episodecnt &gt; 8)
					itemSize = 8;
				else
					itemSize = episodecnt;
				print("Purchase Episode Size is ", itemSize);
				totalpage = 1;
				pageindex = 0;
				setItemFocus(0);
			}
			else if(getEnv("redirect") == "yes")
			{
				setRefreshTime(50);
			}
			redrawDisplay();
		}
	}
	else{
		movieindex = getFocusItemIndex();
		BackuptitleArray = cateNameArray;
		BackupThumbArray = cateFocusIconArray;
		BackupItemsize = itemSize;
		Backuppagecontext = pagecontext;
		moviethumbnail=getStringArrayAt(cateFocusIconArray , movieindex);
		movietitle=getStringArrayAt(cateNameArray , movieindex);
		menuindex = getEnv("guidemenuindex");
		menutitle = getStringArrayAt(menutitleArray, menuindex);
		if(menutitle == "$[ACE_NEW_RELEASES]"){
			category = "Generic";
		}
		else if(menutitle == "$[ACE_MOST_POPULAR]"){
			category = "Generic";
		}
		else if(menutitle == "$[ACE_BROWSE]"){
			category = "CategoryBrowsing";
		}
		else if(menutitle == "$[ACE_SEARCH]"){
			category = "Search";
		}
		
		showIdle();
		pagecontext = "moviedetail";
		
		
		isInitialState = "yes";
		resetMultiPage();
		resetViewArea = "yes";
		
		Ratingtext =  "$[ACE_RATING]"+": " + AceTrax_getMovieInfo(category,movieindex,"rating");
		Runtimetext =  "$[ACE_RUNTIME]" +": " + AceTrax_getMovieInfo(category,movieindex,"runtime");
		Sizetext =   "$[ACE_FILESIZE]" +": " + AceTrax_getMovieInfo(category,movieindex,"filesize");
		
		countryInfo = AceTrax_getMovieInfo(category,movieindex,"country");
		
		directortext = AceTrax_getMovieInfo(category,movieindex,"director");
		actortext = AceTrax_getMovieInfo(category,movieindex,"actors");
		year = AceTrax_getMovieInfo(category,movieindex,"year");
		yeartext = "$[ACE_RELEASED]" + ": "+ year;
		
		buySize = AceTrax_getMovieResourceBuyorRentInfo(category,movieindex,"buy",0,"filesize");
		buyprice = AceTrax_getMovieResourceBuyorRentInfo(category,movieindex,"buy",0,"price");
		buysymbol =  AceTrax_getMovieResourceBuyorRentInfo(category,movieindex,"buy",0,"currency");
		if(buysymbol == "GBP")
			buysymbol = "$[ACE_GBP]";
		else if(buysymbol == "EUR")
			buysymbol = "$[ACE_EURO]";
		buytext = "buy: "+ buyprice;
		buylang = AceTrax_getMovieResourceBuyorRentInfoList(category, movieindex, "buy", "lang");
		buyNumber = AceTrax_getMovieResourceBuyorRentSize(category, movieindex, "buy");
		
		rentSize = AceTrax_getMovieResourceBuyorRentInfo(category,movieindex,"rent",0,"filesize");
		rentprice = AceTrax_getMovieResourceBuyorRentInfo(category,movieindex,"rent",0,"price");
		rentsymbol =  AceTrax_getMovieResourceBuyorRentInfo(category,movieindex,"rent",0,"currency");
		if(rentsymbol == "GBP")
			rentsymbol = "$[ACE_GBP]";
		else if(rentsymbol == "EUR")
			rentsymbol = "$[ACE_EURO]";
		renttext = "rent: "+ rentprice;
		rentlang = AceTrax_getMovieResourceBuyorRentInfoList(category, movieindex, "rent", "lang");
		rentNumber = AceTrax_getMovieResourceBuyorRentSize(category, movieindex, "rent");

		currency = AceTrax_getMovieResourceBuyorRentInfo(category,movieindex,"buy",0,"currency");
		offerid = AceTrax_getMovieResourceBuyorRentInfo(category,movieindex,"buy",0,"offer_id");

		HasEpisodes = AceTrax_getMovieInfo(category,movieindex,"content_type");
		showsynopsis = "true";
		pageindex1 = 0;
		textPageIndex = 0;
		textPageCount = 0;
		textReachEnd = 0;
		totalItem = 0;
		fullnews = AceTrax_getMovieInfo(category,movieindex,"synopsis");
		cateNameArray = null;
		itemSize=1;
		cateNameArray  = pushBackStringArray(cateNameArray, "$[ACE_TRAILER]");
		if( buyNumber &gt; 0 )
		{
			cateNameArray  = pushBackStringArray(cateNameArray, "$[ACE_BUY]");
			languageInfo = buylang;
			languageSize = buyNumber;
			itemSize = Add(itemSize, 1);
		}
		if( rentNumber &gt; 0)
		{
			cateNameArray  = pushBackStringArray(cateNameArray, "$[ACE_RENT]");
			languageInfo = rentlang;
			languageSize = rentNumber; 
			itemSize = Add(itemSize, 1);
		}
		if( HasEpisodes=="Series Season" )
		{
			channelid = AceTrax_getMovieInfo(category,movieindex,"channel_id");
			contentid = AceTrax_getMovieInfo(category,movieindex,"content_id");
			AceTrax_updateDetail("Detail",channelid,contentid);
			cateNameArray  = pushBackStringArray(cateNameArray, "$[ACE_EPISODES]");
			itemSize = Add(itemSize, 1);
		}
		languageSize_backup = languageSize;
		print("totally language: ", languageSize);
		setFocusItemIndex(0);
		setItemFocus(0);
	}
}
redrawDisplay();
nexturl;
</onClick>
</item_template>


<submenu name="$[ACE_NEW_RELEASES]">
        <onClick>
            <script>
				resetViewArea = "yes";
				pagecontext = "newrelease";
				setRefreshTime(-1);
				playItemURL(-1, 8193);
				showIdle();
				banner=getStringArrayAt(banerarray , 1);
				setEnv("categoryType", "shownewmovie");
				AceTrax_updateGeneric("Top_NewRelease_Movies");
				cateNameArray=AceTrax_getMovieInfoList("Generic", "title");
				itemSize=AceTrax_getMovieSize("Generic");
				cateFocusIconArray=AceTrax_getMovieInfoList("Generic", "image");
				banerarray=AceTrax_getBannerImageURLList();
				banner=getStringArrayAt(banerarray , 0);
				setEnv("guidemenuindex","0");
				ListmyEpisode = "false";
				redrawDisplay();
				postMessage("down");
            </script>
        </onClick>
</submenu>	
<submenu name="$[ACE_MOST_POPULAR]">
        <onClick>
            <script>
				banner = getStringArrayAt(banerarray , 2);
				setRefreshTime(-1);
				playItemURL(-1, 8193);
				redrawDisplay();
				"Ace_mostpopular.rss";
            </script>
        </onClick>
</submenu>	
<submenu name="$[ACE_BROWSE]">
        <onClick>
            <script>
				resetViewArea = "yes";
				pagecontext = "browse";
				setRefreshTime(-1);
				playItemURL(-1, 8193);
				banner=getStringArrayAt(banerarray, 4);
				setEnv("categoryType", "showmoviecategory");
				showIdle();
				AceTrax_updateCategoryBrowsing("category_movies", 0);
				ListmyEpisode = "false";
				cateNameArray=AceTrax_getCategoryInfoList("category_movies", "title");
				idArray=AceTrax_getCategoryInfoList("category_movies", "id");
				cateFocusIconArray=AceTrax_getCategoryInfoList("category_movies", "image");
				itemSize=AceTrax_getSizeByBannerCategoryName("category_movies");
				if(itemSize &gt;0)
					setFocusItemIndex(0);
				pageindex = 0;
				totalpage = 1;
				setEnv("guidemenuindex","2");
				redrawDisplay();
				postMessage("down");
            </script>
        </onClick>
</submenu>	
<submenu name="$[ACE_SEARCH]">
        <onClick>
            <script>
				setRefreshTime(-1);
				playItemURL(-1, 8193);
				keyword= getInput("username, acetrax", "doModal"); 
				url = null;
				if (keyword!=null) { 
					print("search , ",keyword);
					showIdle();
					AceTrax_updateSearch(keyword,0);
					tmpitemSize=AceTrax_getMovieSize("Search");
					if(tmpitemSize &gt; 0){
						itemSize = tmpitemSize;
						setFocusItemIndex(0);
						setEnv("searchkeyword",keyword);
						ListmyEpisode = "false";
						totalpage=AceTrax_getMoviePageSize("Search");
						print("totalpage.......,",totalpage);
						pageindex = 0;
						setEnv("categoryType","showsearch");
						resetViewArea = "yes";
						pagecontext = "search";
						cateNameArray=AceTrax_getMovieInfoList("Search", "title");
						print("cateNameArray , ",cateNameArray);
						cateFocusIconArray=AceTrax_getMovieInfoList("Search", "image");
						print("cateFocusIconArray , ",cateFocusIconArray);
						redrawDisplay("item");
						setEnv("guidemenuindex","3");
						postMessage("down");
					}
					else{
						setEnv("errormsg","$[ACE_NO_RESULTS_MATCH]");
						doModalRss("Ace_genericError.rss");
						redrawDisplay();
					}
				}
				else {
					setEnv("errormsg","$[ACE_NO_INPUT_GIVEN]");
					doModalRss("Ace_genericError.rss");
					redrawDisplay();
				}
				url;
            </script>
        </onClick>
</submenu>

<submenu name="$[ACE_MY_MOVIES]">
        <onClick>
            <script>
				registered = AceTrax_IsRegister();
				nexturl=null;
				if (registered == "true")
				{
					userlogin = AceTrax_IsLoginSTB();
					print("islogin,.....",userlogin);
					setRefreshTime(-1);
					playItemURL(-1, 8193);
					if(userlogin == "true")
					{
						setEnv("guidemenuindex", "4");
						ListmyEpisode = "false";
						showIdle();
						AceTrax_updateMyMovies(0);
						pagecontext = "mymovies";
						resetViewArea = "yes";
						setEnv("categoryType","showmymovies");
					
						itemSize = AceTrax_getPurchaseSize();
						totalpage = AceTrax_getMoviePageSize("mymovies");
						print("======> items in my movies: ", itemSize);
						print("======> totalpage in my movies: ", totalpage);
						if (totalpage != null)
						{
							pageindex = 0;
							titleArray = AceTrax_getPurchaseAssetsInfoList("title");
							languageArray = AceTrax_getPurchaseAssetsInfoList("language");
							LicenceArray = AceTrax_getPurchaseLicenseInfoList("type");
							RemainingArray = AceTrax_getPurchaseLicenseInfoList("expire");

							setFocusItemIndex(0);
							postMessage("down");
						}
						redrawDisplay();
					}
					else
					{
						/* if we are in synopsis, unsetenv to avoid cateNameArray reset in onEnter */
						if (pagecontext == "moviedetail")
						{
							unsetEnv("categoryType");
						}
						/* if login success, display movie list in guide page */
						setEnv("redirect", "no");
						nexturl = "Ace_login.rss";
						setEnv("switchFrom", "Mymovies");
						redrawDisplay();
					}
				}
				else
				{
					playItemURL(-1, 8193);
					setEnv("errormsg", "$[ACE_DEVICE_NOT_REGISTERED]");
					nexturl = "Ace_genericError.rss";
					redrawDisplay();
				}
				nexturl;
            </script>
        </onClick>
</submenu>

<submenu name="$[ACE_MYACCOUNT]">
        <onClick>
            <script>
				playItemURL(-1, 8193);
				redrawDisplay();
				/* if we are in synopsis, unsetenv to avoid cateNameArray reset in onEnter */
				if(pagecontext == "moviedetail")
				{
					unsetEnv("categoryType");
				}
				"Ace_account.rss";
            </script>
        </onClick>
</submenu>

<submenu name="$[ACE_ADULT]">
        <onClick>
            <script>
				setRefreshTime(-1);
				playItemURL(-1, 8193);
				setEnv("guidemenuindex","6");
				redrawDisplay();
				null;
            </script>
        </onClick>
</submenu>

<channel>
<title>Aceguide</title>
<link>Ace_guide.rss</link>
<media:thumbnail url="../image/bestv_logo.fsp" />

<itemSize>
<script>
itemSize;
</script>
</itemSize>

</channel>
</rss>
